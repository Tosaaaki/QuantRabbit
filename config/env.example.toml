gcp_location = "asia-northeast1"
gcp_project_id = "your-project-id"
gcp_pubsub_topic = "quant-topic"
ui_bucket_name = "fx-ui-realtime"
ui_state_object_path = "realtime/ui_state.json"
ui_service_account_email = "ui-dashboard-sa@quantrabbit.iam.gserviceaccount.com"
AUTOTUNE_BQ_TABLE = "quantrabbit.autotune_runs"
AUTOTUNE_BQ_SETTINGS_TABLE = "quantrabbit.autotune_settings"

oanda_account_id = "000-000-00000000-000"
oanda_token = "replace-with-your-token"
oanda_practice = "true"
oanda_hedging_enabled = "true"  # allow offsetting long/short positions

# OANDA REST cache (multi-worker load guard)
# - Shared cache uses logs/*.json so multiple workers can reuse snapshots.
# - TTL is small by default; set to 0 to disable caching.
OANDA_ACCOUNT_SNAPSHOT_TTL_SEC = "1.0"
OANDA_POSITION_SUMMARY_TTL_SEC = "1.0"
OANDA_SHARED_CACHE_ENABLED = "1"
OANDA_SHARED_CACHE_ALLOW_STALE_SEC = "5"
OANDA_SHARED_CACHE_LOCK_STALE_SEC = "12"

tradingeconomics_api_key = "client:secret"  # format: <client>:<secret>

# LLM provider (Vertex-only recommended)
# NOTE: main loop no longer calls LLM (decider/advisors removed).
# These settings are only used by ops/policy/analytics tooling.
LLM_PROVIDER = "vertex"               # legacy (ignored)
GPT_DECIDER_PROVIDER = "vertex"       # legacy (ignored)
GPT_SUMMARIZER_PROVIDER = "vertex"    # legacy (ignored)
LLM_IN_MAIN_ENABLED = "0"             # legacy (ignored by main loop)
VERTEX_PROJECT_ID = "your-project-id" # optional (ADC default if omitted)
VERTEX_DECIDER_MODEL = "gemini-2.0-flash"
VERTEX_SUMMARIZER_MODEL = "gemini-2.0-flash"
VERTEX_OPTIMIZER_MODEL = "gemini-2.0-flash"
VERTEX_DECIDER_TIMEOUT_SEC = "20"
VERTEX_SUMMARIZER_TIMEOUT_SEC = "20"
VERTEX_OPTIMIZER_TIMEOUT_SEC = "20"
LLM_OPS_POLICY_PROVIDER = "vertex"    # legacy (ignored)
LLM_OPS_POLICY_MODEL = "gemini-2.0-flash"  # legacy
LLM_OPS_POLICY_TIMEOUT_SEC = "20"
LLM_OPS_POLICY_MAX_TOKENS = "900"
LLM_OPS_POLICY_HOURS = "6"
LLM_OPS_POLICY_APPLY = "0"            # 1: apply ops policy diff to overlay
LLM_OPS_POLICY_EXCLUDE_PERF = "0"     # 1: exclude performance metrics from ops policy input
GPT_STRICT_REQUIRED = "0"             # legacy (ignored by main loop)
GPT_DECIDER_BLOCKING = "0"            # legacy (ignored by main loop)
GPT_DECIDER_WAIT_TIMEOUT_SEC = "8"    # legacy (ignored by main loop)

# Worker Brain (LLM, per-strategy gate)
# - Uses Vertex (Gemini) via utils/vertex_client.py
# - Applies at order_manager preflight to allow/reduce/block entries
BRAIN_ENABLED = "0"
BRAIN_VERTEX_MODEL = "gemini-2.0-flash"
BRAIN_TEMPERATURE = "0.2"
BRAIN_MAX_TOKENS = "256"
BRAIN_TIMEOUT_SEC = "6"
BRAIN_SAMPLE_RATE = "1.0"
BRAIN_TTL_SEC = "90"
BRAIN_MEMORY_TTL_H = "72"
BRAIN_MAX_CONTEXT_CHARS = "1200"
BRAIN_MIN_SCALE = "0.2"
# Optional cost estimation (per 1K tokens; set to >0 to emit brain_cost_est)
# BRAIN_COST_INPUT_PER_1K = "0.000"
# BRAIN_COST_OUTPUT_PER_1K = "0.000"
# Persona control (optional)
BRAIN_PERSONA_ENABLED = "1"
BRAIN_PERSONA_MODE = "auto" # auto|uniform
BRAIN_PERSONA_DEFAULT = "Seasoned discretionary FX trader focused on risk-first entries."
# JSON overrides by strategy tag (string or object with name/traits/bias/avoid)
# BRAIN_PERSONA_OVERRIDES = "{\"trendma\":{\"name\":\"Trend veteran\",\"traits\":\"waits for clean trends\",\"bias\":\"block chop\",\"avoid\":\"range fades\"}}"
# Optional allowlists (comma-separated). If empty, allow all.
# BRAIN_STRATEGY_ALLOWLIST = "TrendMA,H1Momentum,BB_RSI"
# BRAIN_POCKET_ALLOWLIST = "micro,scalp"

# Forecast gate (scikit-learn, offline bundle)
# - Uses bundle when available; otherwise falls back to deterministic technical forecast.
# - Applies at order_manager preflight to allow/reduce/block entries
FORECAST_GATE_ENABLED = "1"
FORECAST_BUNDLE_PATH = "config/forecast_models/USD_JPY_bundle.joblib"
FORECAST_GATE_TTL_SEC = "15"
FORECAST_GATE_SOURCE = "auto"         # auto|bundle|technical
FORECAST_GATE_AUTO_BLEND_TECH = "0.35"
FORECAST_GATE_EDGE_BLOCK = "0.38"
FORECAST_GATE_EDGE_BAD = "0.45"
FORECAST_GATE_EDGE_REF = "0.55"
FORECAST_GATE_SCALE_MIN = "0.5"
FORECAST_TECH_ENABLED = "1"
FORECAST_TECH_SCORE_GAIN = "1.0"
FORECAST_TECH_PROB_STRENGTH = "0.75"
FORECAST_GATE_STYLE_GUARD_ENABLED = "1"
FORECAST_GATE_STYLE_TREND_MIN_STRENGTH = "0.52"
FORECAST_GATE_STYLE_RANGE_MIN_PRESSURE = "0.52"
FORECAST_GATE_EDGE_BLOCK_TREND = "0.41"
FORECAST_GATE_EDGE_BLOCK_RANGE = "0.35"
# Per-strategy overrides (suffix = normalized strategy base tag)
# e.g. TrendMA -> TRENDMA, BB_RSI -> BBRSI
# FORECAST_GATE_STYLE_TREND_MIN_STRENGTH_STRATEGY_TRENDMA = "0.58"
# FORECAST_GATE_EDGE_BLOCK_TREND_STRATEGY_TRENDMA = "0.45"
# FORECAST_GATE_STYLE_RANGE_MIN_PRESSURE_STRATEGY_BBRSI = "0.65"
# FORECAST_GATE_EDGE_BLOCK_RANGE_STRATEGY_BBRSI = "0.32"
# Freshness guard (optional; block if candles are stale)
FORECAST_GATE_REQUIRE_FRESH = "0"
FORECAST_GATE_MAX_AGE_SEC = "120"
# Horizon selection by pocket (defaults)
FORECAST_GATE_HORIZON_SCALP_FAST = "1m"
FORECAST_GATE_HORIZON_SCALP = "5m"
FORECAST_GATE_HORIZON_MICRO = "8h"
FORECAST_GATE_HORIZON_MACRO = "1d"
FORECAST_GATE_TECH_PREFERRED_HORIZONS = "1m,5m,10m"

# Pattern-book gate (disabled globally by default, worker opt-in推奨)
ORDER_PATTERN_GATE_ENABLED = "1"
ORDER_PATTERN_GATE_GLOBAL_OPT_IN = "0"     # 1で全戦略に共通適用
ORDER_PATTERN_GATE_TTL_SEC = "20"
ORDER_PATTERN_GATE_DB_PATH = "logs/patterns.db"
ORDER_PATTERN_GATE_JSON_PATH = "config/pattern_book_deep.json"
ORDER_PATTERN_GATE_POCKET_ALLOWLIST = "micro,macro,scalp,scalp_fast"
ORDER_PATTERN_GATE_STRATEGY_ALLOWLIST = ""  # 例: "scalp_ping_5s_live,TrendMA"
ORDER_PATTERN_GATE_BLOCK_QUALITIES = "avoid"
ORDER_PATTERN_GATE_REDUCE_QUALITIES = "weak"
ORDER_PATTERN_GATE_SCALE_MIN_TRADES = "30"
ORDER_PATTERN_GATE_BLOCK_MIN_TRADES = "90"
ORDER_PATTERN_GATE_ALLOW_BOOST = "1"
ORDER_PATTERN_GATE_SCALE_MIN = "0.70"
ORDER_PATTERN_GATE_SCALE_MAX = "1.20"
ORDER_PATTERN_GATE_MIN_SCALE_DELTA = "0.03"

# TP calibration from recent strategy close history
ORDER_TP_HISTORY_ENABLED = "1"
ORDER_TP_HISTORY_LOOKBACK_DAYS = "21"
ORDER_TP_HISTORY_MIN_TRADES = "12"
ORDER_TP_HISTORY_MIN_TP_TRADES = "5"
ORDER_TP_HISTORY_TTL_SEC = "120"
ORDER_TP_HISTORY_DB_PATH = "logs/trades.db"
ORDER_TP_HISTORY_MIN_PIPS = "0.0"
ORDER_TP_HISTORY_MAX_PIPS = "0.0"

# Per-worker opt-in example
SCALP_PING_5S_PATTERN_GATE_OPT_IN = "1"
SCALP_M1SCALPER_PATTERN_GATE_OPT_IN = "1"
MICRO_RANGEBREAK_PATTERN_GATE_OPT_IN = "1"
MICRO_RANGEBREAK_PATTERN_GATE_ALLOW_GENERIC = "1"
MICRO_VWAPBOUND_PATTERN_GATE_OPT_IN = "1"
M1SCALP_USDJPY_SETUP_GATING = "0"
M1SCALP_USDJPY_PULLBACK_BAND_PIPS = "2.6"
M1SCALP_USDJPY_BREAK_LOOKBACK_M1 = "18"
M1SCALP_USDJPY_BREAK_LOOKBACK_M5 = "12"
M1SCALP_USDJPY_BREAK_MARGIN_PIPS = "1.4"
M1SCALP_USDJPY_PULLBACK_SIZE_MULT = "0.98"
M1SCALP_USDJPY_BREAK_SIZE_MULT = "1.05"
# Optional allowlists (comma-separated). If empty, allow all.
# FORECAST_GATE_STRATEGY_ALLOWLIST = "TrendMA,MicroVWAPRevert"
# FORECAST_GATE_POCKET_ALLOWLIST = "micro,scalp,scalp_fast,macro"

# FastScalp optional pattern model gate (joblib, see scripts/train_fast_scalp_pattern.py)
FAST_SCALP_PATTERN_MODEL_PATH = ""
FAST_SCALP_PATTERN_MIN_PROB = "0.62"

# Entry/exit routing
SIGNAL_GATE_ENABLED = "0"            # 1: main gate ranks worker signals
ORDER_FORWARD_TO_SIGNAL_GATE = "0"   # 1: workers enqueue to gate instead of direct orders
EXIT_MANAGER_DISABLED = "1"          # 0: enable legacy ExitManager (not recommended)
ENTRY_TECH_CONTEXT_ENABLED = "1"     # 1: strategy_entry が technical_context（indicators/ticks/request）を注入
ENTRY_TECH_CONTEXT_STRATEGY_REQUIREMENTS = "0"  # 1: strategy_entry が戦略タグ契約で technical_context を自動補完
ENTRY_TECH_DEFAULT_TFS = "D1,H4,H1,M5,M1" # エントリー時の技術指標抽出対象TF順（空ならstrategy/pocket既定）

# V2 order/position service mode
ORDER_MANAGER_SERVICE_ENABLED = "0"                # 1: route order actions to quant-order-manager
ORDER_MANAGER_SERVICE_URL = "http://127.0.0.1:8300"
ORDER_MANAGER_SERVICE_TIMEOUT = "5.0"
ORDER_MANAGER_SERVICE_FALLBACK_LOCAL = "0"         # 1: on service failure, fallback local call
ORDER_MANAGER_PRESERVE_INTENT_MIN_SCALE = "0.35"  # preserve intent スケール下限（min_units保護前）
ORDER_MANAGER_PRESERVE_INTENT_REJECT_UNDER = "0.0"  # この確率以下は拒否
ORDER_MANAGER_PRESERVE_INTENT_MAX_SCALE = "1.25"  # 高確率時の上振れ上限（>1 で拡大）
ORDER_MANAGER_PRESERVE_INTENT_BOOST_PROBABILITY = "0.80"  # この確率以上で上方向スケール
# Entry intent coordination (blackboard)
ORDER_INTENT_COORDINATION_ENABLED = "1"
ORDER_INTENT_COORDINATION_WINDOW_SEC = "2.0"
ORDER_INTENT_COORDINATION_REJECTION_DOMINANCE = "1.12"  # 逆方向圧力の監視比率（現行ロジックは方向意図を維持して通過）
# 戦略別 override 例:
# ORDER_INTENT_COORDINATION_REJECTION_DOMINANCE_STRATEGY_SCALP_PING_5S="1.20"
ORDER_INTENT_COORDINATION_MIN_SCALE = "0.20"
POSITION_MANAGER_SERVICE_ENABLED = "0"             # 1: route position queries to quant-position-manager
POSITION_MANAGER_SERVICE_URL = "http://127.0.0.1:8301"
POSITION_MANAGER_SERVICE_TIMEOUT = "5.0"
POSITION_MANAGER_SERVICE_FALLBACK_LOCAL = "0"      # 1: on service failure, fallback local call

# micro_runtime exit tuning (micro pocket)
# - Enable the dedicated exit worker and tune for higher exits.
MICRO_MULTI_EXIT_ENABLED = "1"
MICRO_MULTI_EXIT_PROFIT_PIPS = "2.6"
MICRO_MULTI_EXIT_TRAIL_START_PIPS = "3.4"
MICRO_MULTI_EXIT_TRAIL_BACKOFF_PIPS = "1.0"
MICRO_MULTI_EXIT_LOCK_BUFFER_PIPS = "0.6"
MICRO_MULTI_EXIT_RANGE_PROFIT_PIPS = "2.0"
MICRO_MULTI_EXIT_RANGE_TRAIL_START_PIPS = "2.6"
MICRO_MULTI_EXIT_RANGE_TRAIL_BACKOFF_PIPS = "0.8"
MICRO_MULTI_EXIT_RANGE_LOCK_BUFFER_PIPS = "0.4"
MICRO_MULTI_EXIT_PARTIAL_TRIGGER_PIPS = "1.5"
MICRO_MULTI_EXIT_PARTIAL_TRIGGER_PIPS_LOWVOL = "1.2"

# Stop-loss / protections
# まずこの1本を使う: ORDER_FIXED_SL_MODE
#  - 1: 全 pocket で stopLossOnFill 常時 ON
#  - 0: 全 pocket で stopLossOnFill 常時 OFF
# ORDER_FIXED_SL_MODE = "1"   # 1=常時ON, 0=常時OFF
# strategy-local override (global mode unset/0でも有効化したい場合):
# ORDER_ALLOW_STOP_LOSS_ON_FILL_SCALP_PING_5S_B = "1"
# ORDER_DISABLE_ENTRY_HARD_STOP_SCALP_PING_5S_B = "0"
# ORDER_DISABLE_ENTRY_HARD_STOP_SCALP_PING_5 = "1"
# SCALP_PING_5S_B_USE_SL = "1"
# SCALP_PING_5S_B_DISABLE_ENTRY_HARD_STOP = "0"
# SCALP_PING_5S_B_FAST_DIRECTION_FLIP_ENABLED = "1"
# SCALP_PING_5S_B_FAST_DIRECTION_FLIP_DIRECTION_SCORE_MIN = "0.38"
# SCALP_PING_5S_B_FAST_DIRECTION_FLIP_HORIZON_SCORE_MIN = "0.18"
# SCALP_PING_5S_B_FAST_DIRECTION_FLIP_HORIZON_AGREE_MIN = "2"
# SCALP_PING_5S_B_FAST_DIRECTION_FLIP_MOMENTUM_MIN_PIPS = "0.06"
# SCALP_PING_5S_B_FAST_DIRECTION_FLIP_COOLDOWN_SEC = "0.4"
# 旧式キーは削除対象。ORDER_FIXED_SL_MODE 未設定でも既定 OFF のため、
# 運用時は明示的に 1 または 0 を設定してください。
ALLOW_TRAILING_STOP_LOSS = "true"
#
# Hard SL (catastrophic stop) for NEW entries only:
# - stopLossOnFill に付与する「最低距離(pips)」を指定する（戦略の sl_pips がタイトでも widening する）
# - 0 の場合は無効
# ORDER_ENTRY_HARD_STOP_PIPS = "0"
# ORDER_ENTRY_HARD_STOP_PIPS_SCALP = "25"
# ORDER_ENTRY_HARD_STOP_PIPS_STRATEGY_TICKIMBALANCE = "50"
# ORDER_ENTRY_HARD_STOP_PIPS_SCALP_FAST = "35"

# ScalpPrecision Exit (RangeFader) loss-cut (optional; recommended: new trades only)
# - pnl<=0 の建玉を「複合条件 or 閾値」で損切りする（既存の profit-only EXIT を補完）
# - REQUIRE_SL=true にすると broker SL が付いている建玉のみ対象（新規のみ運用がしやすい）
# RANGEFADER_EXIT_LOSS_CUT_ENABLED = "false"
# RANGEFADER_EXIT_LOSS_CUT_REQUIRE_SL = "true"
# RANGEFADER_EXIT_LOSS_CUT_SOFT_PIPS = "12"
# RANGEFADER_EXIT_LOSS_CUT_HARD_PIPS = "30"
# RANGEFADER_EXIT_LOSS_CUT_MAX_HOLD_SEC = "1200"
# RANGEFADER_EXIT_LOSS_CUT_COOLDOWN_SEC = "8"
# RANGEFADER_EXIT_LOSS_CUT_REASON_SOFT = "m1_structure_break"
# RANGEFADER_EXIT_LOSS_CUT_REASON_HARD = "max_adverse"
# RANGEFADER_EXIT_LOSS_CUT_REASON_TIME = "time_stop"

# Pro-style global loss cut (optional; deterministic, non-LLM)
# - Cuts losers after min hold when structure breaks or time stops.
# - Per-worker thresholds live in config/strategy_exit_protections.yaml (pro_stop).
# PRO_STOP_ENABLED = "false"
# PRO_STOP_POCKETS = "micro,macro,scalp,scalp_fast"
# PRO_STOP_SCORE_MIN = "2"
# PRO_STOP_REQUIRE_SIGNAL = "true"
# PRO_STOP_COOLDOWN_SEC = "20"
# PRO_STOP_USE_POCKET_DEFAULTS = "0"
# PRO_STOP_SOFT_PIPS = "3.4"
# PRO_STOP_HARD_PIPS = "9.5"
# PRO_STOP_MIN_HOLD_SEC = "203"
# PRO_STOP_MAX_HOLD_SEC = "1760"
# PRO_STOP_SOFT_ATR_MULT = "1.0"
# PRO_STOP_HARD_ATR_MULT = "1.2"
# PRO_STOP_RSI_FADE_LONG = "44"
# PRO_STOP_RSI_FADE_SHORT = "56"
# PRO_STOP_VWAP_GAP_PIPS = "0.8"
# PRO_STOP_STRUCTURE_ADX = "20"
# PRO_STOP_STRUCTURE_GAP_PIPS = "1.8"
# PRO_STOP_ATR_SPIKE_PIPS = "5.0"

# BigQuery (Looker Studio / 集計用)
BQ_PROJECT = "your-project-id"          # 省略時は GOOGLE_CLOUD_PROJECT を使用
BQ_DATASET = "quantrabbit"              # bq_exporter の既定に合わせる
BQ_TRADES_TABLE = "trades_raw"          # bq_exporter の既定
BQ_LOCATION = "asia-northeast1"
# BigQuery (ops insights / 監視・品質)
BQ_EXECUTION_QUALITY_TABLE = "execution_quality"
BQ_MARKET_STATE_TABLE = "market_state"
BQ_EXPOSURE_TABLE = "exposure_snapshot"
BQ_OPS_HEALTH_TABLE = "ops_health"
BQ_OPS_INSIGHTS_LOOKBACK_MIN = "120"
BQ_OPS_INSIGHTS_RETENTION_H = "168"
BQ_ORDERS_DB = "logs/orders.db"
BQ_METRICS_DB = "logs/metrics.db"
OPS_HEALTH_SNAPSHOT_PATH = "logs/health_snapshot.json"
OPS_EXPOSURE_INSTRUMENT = "USD_JPY"
OPS_EXEC_QUALITY_ENABLED = "1"
OPS_MARKET_STATE_ENABLED = "1"
OPS_EXPOSURE_ENABLED = "1"
OPS_HEALTH_ENABLED = "1"

# Firestore (strategy score snapshot)
FIRESTORE_PROJECT = "your-project-id"   # 省略時は BQ_PROJECT / GCP_PROJECT を利用
FIRESTORE_COLLECTION = "strategy_scores"
FIRESTORE_DOCUMENT = "current"
FIRESTORE_STRATEGY_ENABLE = "false"     # VM 側で Firestore 戦略スコアを読む場合のみ true
FIRESTORE_STRATEGY_TTL_SEC = "60"       # VM 読み取りキャッシュ TTL（秒）
FIRESTORE_STRATEGY_APPLY_SLTP = "false" # SL/TP 推奨値を適用するなら true（初期は無効）

# Level map (price buckets / reversal map)
LEVEL_MAP_ENABLE = "false"              # level_map.json を読む場合のみ true（初期は無効）
LEVEL_MAP_TTL_SEC = "300"
LEVEL_MAP_OBJECT_PATH = "analytics/level_map.json"

# Policy loop (Vertex AI)
POLICY_OVERLAY_PATH = "logs/policy_overlay.json"
POLICY_HISTORY_DIR = "logs/policy_history"
POLICY_LATEST_PATH = "logs/policy_latest.json"
POLICY_REFRESH_SEC = "5"
POLICY_TIMEZONE = "Asia/Tokyo"
POLICY_VOL_BUCKETS = "2,4,6"
BQ_POLICY_TABLE = "policy_history"
POLICY_GCS_PREFIX = "policy"
VERTEX_LOCATION = "us-central1"
VERTEX_POLICY_MODEL = "gemini-2.0-flash"
POLICY_SHADOW_MODEL = "gpt-5-mini"
SIGNAL_GATE_POLICY_ENABLED = "0"      # 1: policy overlay filters worker signals at gate
POLICY_HEURISTIC_PERF_BLOCK_ENABLED = "1"  # 0: disable heuristic perf-based auto-block
POLICY_RULES_ENABLED = "1"            # 1: enable non-perf policy rules (range/spread/trend)
POLICY_TREND_STRENGTH_MIN = "1.0"     # H4 trend strength threshold (net/avg_range)
POLICY_TREND_STRENGTH_MIN_H1 = "1.0"  # H1 trend strength threshold (net/avg_range)
POLICY_SPREAD_P95_PIPS = "1.4"        # scalp soft throttle when spread p95 exceeds this
POLICY_BQ_INSIGHTS_ENABLED = "0"      # 1: load BQ ops insights in policy loop
POLICY_BQ_RANGE_ACTIVE_RATIO = "0.6"  # range_active_ratio >= threshold -> range mode
POLICY_BQ_SNAPSHOT_MAX_AGE_MIN = "15" # stale guard for BQ snapshots
POLICY_BQ_EXEC_MIN_ORDERS = "10"      # min orders to trust reject/latency stats
POLICY_BQ_REJECT_RATE_MAX = "0.01"    # reject_rate >= threshold -> entry block
POLICY_BQ_DATA_LAG_P95_MAX = "1500"   # data_lag_ms p95 threshold
POLICY_BQ_LATENCY_P95_MAX = "2000"    # decision_latency_ms p95 threshold
POLICY_BQ_FREE_MARGIN_MIN = "0.08"    # free_margin_ratio below -> entry block
OPS_REPLAY_DIR = "logs/replay/USD_JPY"

# Policy guard (auto rollback)
POLICY_GUARD_LOOKBACK_MIN = "120"
POLICY_GUARD_STABLE_MIN_SEC = "1800"
POLICY_GUARD_STABLE_PATH = "logs/policy_stable.json"
POLICY_GUARD_METRICS_DB = "logs/metrics.db"
POLICY_GUARD_ORDERS_DB = "logs/orders.db"
POLICY_GUARD_MAX_DECISION_MS = "2000"
POLICY_GUARD_MAX_DATA_LAG_MS = "1500"
POLICY_GUARD_MAX_DRAWDOWN_PCT = "0.18"
POLICY_GUARD_MIN_ORDER_SUCCESS = "0.995"
POLICY_GUARD_MAX_REJECT_RATE = "0.01"
POLICY_GUARD_MAX_GPT_TIMEOUT = "0.05"
POLICY_GUARD_REJECT_STREAK = "3"
POLICY_SHADOW_ENABLED = "false"

# --- Risk & sizing ---
# 1 トレードあたりの許容リスク割合（equity 比）。例: 0.01 = 1%
risk_pct = "0.025"

# Base entry units scaling (compounding)
BASE_UNITS_EQUITY_SCALE_ENABLED = "1"
BASE_UNITS_EQUITY_REF = "1000000"
# BASE_UNITS_EQUITY_REF is a numeric baseline; current balance is used each sizing step
BASE_UNITS_EQUITY_SCALE_MIN = "0.2"
# BASE_UNITS_EQUITY_SCALE_MAX = "3.0"
# マルチポケット合流時の最大リスク割合（base〜max で自動調整）
risk_pct_max = "0.1"
# 使用可能証拠金に対する最大使用割合（0.0〜1.0）
max_margin_usage = "0.92"
# Pocket allocation (total lot share)
POCKET_SCALP_SHARE = "0.30"
POCKET_MIN_MICRO_WEIGHT = "0.05"
POCKET_MIN_SCALP_WEIGHT = "0.10"
POCKET_MIN_MACRO_WEIGHT = "0.70"
SCALP_TACTICAL = "0"
# Pocketごとの最小ロット/units（SL無し運用時のスキップ防止用）
RISK_MIN_LOT_SCALP = "0.10"          # 10k units
ORDER_MIN_UNITS_SCALP = "10000"
ORDER_MIN_UNITS_MACRO = "2000"
ORDER_MIN_UNITS_MICRO = "1000"
# --- Entry RR guard (TP>=SL) ---
ORDER_MIN_RR_ENABLED = "1"
ORDER_MIN_RR_MACRO = "1.5"
ORDER_MIN_RR_MICRO = "1.35"
ORDER_MIN_RR_SCALP = "1.2"
ORDER_MIN_RR_SCALP_FAST = "1.15"
ORDER_MIN_RR_MANUAL = "1.0"
ORDER_MIN_RR_ADJUST_MODE = "tp"
# Entry quality gate (confidence + market condition aware)
ORDER_ENTRY_QUALITY_GATE_ENABLED = "1"
ORDER_ENTRY_QUALITY_POCKETS = "micro,macro,scalp,scalp_fast"
ORDER_ENTRY_QUALITY_MIN_CONF_MICRO = "58"
ORDER_ENTRY_QUALITY_MIN_CONF_SCALP = "62"
ORDER_ENTRY_QUALITY_MIN_CONF_SCALP_FAST = "65"
ORDER_ENTRY_QUALITY_BYPASS_CONF = "92"
ORDER_ENTRY_QUALITY_SPREAD_SL_MAX_RATIO_MICRO = "0.34"
ORDER_ENTRY_QUALITY_SPREAD_SL_MAX_RATIO_SCALP = "0.46"
ORDER_ENTRY_QUALITY_SPREAD_TP_MAX_RATIO_MICRO = "0.20"
ORDER_ENTRY_QUALITY_SPREAD_TP_MAX_RATIO_SCALP = "0.28"
ORDER_ENTRY_QUALITY_SPREAD_TP_SOFTEN = "1"
ORDER_ENTRY_QUALITY_SPREAD_TP_SOFTEN_MIN_SCALE = "0.30"
ORDER_ENTRY_QUALITY_SPREAD_TP_SOFTEN_TARGET_RATIO = "0.14"
# Dynamic entry stop-loss (market adaptive)
ORDER_DYNAMIC_SL_RATIO = "1.2"
ORDER_DYNAMIC_SL_MAX_PIPS = "8.0"
ORDER_DYNAMIC_SL_ATR_MULT_MICRO = "0.72"
ORDER_DYNAMIC_SL_SPREAD_MULT_MICRO = "2.8"
# Scalp worker minimums (override defaults as needed)
M1SCALP_MIN_UNITS = "1000"
SCALP_MULTI_MIN_UNITS = "1000"
M1SCALP_BASE_UNITS = "6000"
M1SCALP_CONFIDENCE_FLOOR = "50"
M1SCALP_CONFIDENCE_CEIL = "90"
M1SCALP_EXIT_MAX_HOLD_SEC = "300"
SCALP_MULTI_BASE_UNITS = "6000"
# Strategy-specific size overrides for micro_multi (format: Tag:mult,Tag:mult)
MICRO_MULTI_STRATEGY_UNITS_MULT = ""
M1SCALP_MAX_SPREAD_PIPS = "1.4"
M1SCALP_BLOCK_HOURS_ENABLED = "0"
M1SCALP_BLOCK_HOURS_UTC = ""
# Optional derivative worker filters (empty = disable).
# Example: trend-long copy worker
# M1SCALP_SIGNAL_TAG_CONTAINS = "trend-long"
# M1SCALP_SIDE_FILTER = "long"
# M1SCALP_STRATEGY_TAG_OVERRIDE = "M1Scalper-trend-long-mirror"
M1SCALP_SIGNAL_TAG_CONTAINS = ""
M1SCALP_SIDE_FILTER = ""
M1SCALP_STRATEGY_TAG_OVERRIDE = ""
# Trend reclaim long worker (scalp)
TRRECLAIM_ENABLED = "0"
TRRECLAIM_LOOP_INTERVAL_SEC = "5.0"
TRRECLAIM_COOLDOWN_SEC = "45"
TRRECLAIM_CONF_FLOOR = "52"
TRRECLAIM_CONF_CEIL = "92"
TRRECLAIM_MIN_ENTRY_CONF = "56"
TRRECLAIM_BASE_UNITS = "7000"
TRRECLAIM_MIN_UNITS = "1000"
TRRECLAIM_MAX_SPREAD_PIPS = "1.2"
TRRECLAIM_CAP_MIN = "0.10"
TRRECLAIM_CAP_MAX = "0.85"
TRRECLAIM_RANGE_BLOCK_SCORE = "0.58"
TRRECLAIM_BLOCK_IF_LONG_OPEN = "0"
TRRECLAIM_EXIT_LOOP_INTERVAL_SEC = "0.9"
TRRECLAIM_EXIT_MIN_HOLD_SEC = "20.0"
TRRECLAIM_EXIT_MAX_HOLD_SEC = "900.0"
TRRECLAIM_EXIT_PROFIT_PIPS = "4.5"
TRRECLAIM_EXIT_TRAIL_START_PIPS = "6.0"
TRRECLAIM_EXIT_TRAIL_BACKOFF_PIPS = "2.0"
TRRECLAIM_EXIT_LOCK_BUFFER_PIPS = "1.6"
TRRECLAIM_EXIT_LOCK_TRIGGER_PIPS = "3.2"
TRRECLAIM_EXIT_REV_WINDOW_SEC = "30.0"
TRRECLAIM_EXIT_REV_PIPS = "1.8"
TRRECLAIM_EXIT_ATR_SPIKE_PIPS = "7.0"
TRRECLAIM_EXIT_HARD_STOP_PIPS = "6.0"
TRRECLAIM_EXIT_TP_HINT_RATIO = "0.85"
# TrendReclaimLong strategy tuning
TR_LONG_MIN_ADX = "16.0"
TR_LONG_H1_MIN_ADX = "18.0"
TR_LONG_H1_MIN_GAP_PIPS = "3.0"
TR_LONG_M5_MIN_GAP_PIPS = "0.5"
TR_LONG_MIN_IMPULSE_PIPS = "2.2"
TR_LONG_PULLBACK_DEPTH_MIN_PIPS = "0.6"
TR_LONG_PULLBACK_DEPTH_MAX_PIPS = "5.0"
TR_LONG_PULLBACK_TOUCH_MAX_PIPS = "1.0"
TR_LONG_RECLAIM_MIN_PIPS = "0.10"
TR_LONG_RSI_MIN = "50.0"
TR_LONG_RSI_MAX = "73.0"
# Session/time bias toggles (default off)
M1SCALP_SESSION_BIAS_ENABLED = "0"
MA_CROSS_SESSION_BIAS_ENABLED = "0"
# Tick-oriented worker loops (sub-second)
FAST_SCALP_LOOP_INTERVAL_SEC = "0.25"
PULLBACK_SCALP_LOOP_INTERVAL_SEC = "0.30"
MIRROR_SPIKE_S5_LOOP_INTERVAL_SEC = "0.45"
IMPULSE_MOMENTUM_S5_LOOP_INTERVAL_SEC = "0.40"
SQUEEZE_BREAK_S5_LOOP_INTERVAL_SEC = "0.45"
VWAP_MAGNET_S5_LOOP_INTERVAL_SEC = "0.45"
PULLBACK_S5_LOOP_INTERVAL_SEC = "0.45"
PULLBACK_RUNNER_S5_LOOP_INTERVAL_SEC = "0.45"
IMPULSE_BREAK_S5_LOOP_INTERVAL_SEC = "0.45"
IMPULSE_RETEST_S5_LOOP_INTERVAL_SEC = "0.50"
MIRROR_SPIKE_TIGHT_LOOP_INTERVAL_SEC = "0.50"
# Live provisional factor updates (use in-flight candle before close)
FACTOR_CACHE_LIVE_UPDATE_ENABLED = "1"
FACTOR_CACHE_LIVE_UPDATE_TFS = "M1"
FACTOR_CACHE_LIVE_MIN_INTERVAL_SEC = "0.35"
FACTOR_CACHE_INCLUDE_LIVE_CANDLE = "1"
# Volatility spike rider (scalp)
VOL_SPIKE_RIDER_ENABLED = "0"
VOL_SPIKE_RIDER_LOOP_INTERVAL_SEC = "0.25"
VOL_SPIKE_RIDER_WINDOW_SEC = "6.0"
VOL_SPIKE_RIDER_RECENT_WINDOW_SEC = "2.0"
VOL_SPIKE_RIDER_MIN_MOVE_PIPS = "4.0"
VOL_SPIKE_RIDER_MIN_SPEED_PPS = "0.7"
VOL_SPIKE_RIDER_MIN_TICKS = "18"
VOL_SPIKE_RIDER_MAX_TICKS = "240"
VOL_SPIKE_RIDER_MAX_SPREAD_PIPS = "0.9"
VOL_SPIKE_RIDER_MIN_ATR_PIPS = "2.0"
VOL_SPIKE_RIDER_MAX_MOVE_PIPS = "12.0"
VOL_SPIKE_RIDER_MAX_ATR_MULT = "2.4"
VOL_SPIKE_RIDER_RECENT_MIN_RATIO = "0.25"
VOL_SPIKE_RIDER_RETRACE_PIPS = "1.8"
VOL_SPIKE_RIDER_RETRACE_RATIO = "0.28"
VOL_SPIKE_RIDER_MAX_WICK_RATIO = "0.55"
VOL_SPIKE_RIDER_WICK_MIN_RANGE_PIPS = "3.0"
VOL_SPIKE_RIDER_RSI_MAX_LONG = "78.0"
VOL_SPIKE_RIDER_RSI_MIN_SHORT = "22.0"
VOL_SPIKE_RIDER_SIZE_MIN_MULT = "0.85"
VOL_SPIKE_RIDER_SIZE_MAX_MULT = "1.6"
VOL_SPIKE_RIDER_COOLDOWN_SEC = "20"
VOL_SPIKE_RIDER_POST_EXIT_COOLDOWN_SEC = "15"
VOL_SPIKE_RIDER_MAX_ACTIVE_TRADES = "1"
VOL_SPIKE_RIDER_MIN_UNITS = "1000"
VOL_SPIKE_RIDER_MAX_LOT = "6.0"
VOL_SPIKE_RIDER_RISK_PCT = "0.0"
VOL_SPIKE_RIDER_SL_MIN_PIPS = "2.0"
VOL_SPIKE_RIDER_SL_MAX_PIPS = "10.0"
VOL_SPIKE_RIDER_SL_ATR_MULT = "0.9"
VOL_SPIKE_RIDER_SL_MOVE_MULT = "0.35"
VOL_SPIKE_RIDER_TP_MIN_PIPS = "3.0"
VOL_SPIKE_RIDER_TP_MAX_PIPS = "16.0"
VOL_SPIKE_RIDER_TP_RR = "1.6"
VOL_SPIKE_RIDER_EXIT_LOOP_INTERVAL_SEC = "0.6"
VOL_SPIKE_RIDER_EXIT_MIN_HOLD_SEC = "12"
VOL_SPIKE_RIDER_EXIT_MAX_HOLD_SEC = "180"
VOL_SPIKE_RIDER_EXIT_PROFIT_PIPS = "3.2"
VOL_SPIKE_RIDER_EXIT_TRAIL_START_PIPS = "4.0"
VOL_SPIKE_RIDER_EXIT_TRAIL_BACKOFF_PIPS = "1.0"
VOL_SPIKE_RIDER_EXIT_LOCK_BUFFER_PIPS = "0.8"
VOL_SPIKE_RIDER_EXIT_LOCK_TRIGGER_PIPS = "1.6"
VOL_SPIKE_RIDER_EXIT_REV_WINDOW_SEC = "4.0"
VOL_SPIKE_RIDER_EXIT_REV_PIPS = "3.5"
VOL_SPIKE_RIDER_EXIT_ATR_SPIKE_PIPS = "6.0"
VOL_SPIKE_RIDER_EXIT_HARD_STOP_PIPS = "6.5"
VOL_SPIKE_RIDER_EXIT_TP_HINT_RATIO = "0.75"
# Tech Fusion (multi-tech entry)
TECH_FUSION_ENABLED = "0"
TECH_FUSION_LOOP_INTERVAL_SEC = "8.0"
TECH_FUSION_POCKET = "micro"
TECH_FUSION_MODE = "both"
TECH_FUSION_BASE_ENTRY_UNITS = "20000"
TECH_FUSION_MIN_UNITS = "1500"
TECH_FUSION_CONFIDENCE_FLOOR = "40"
TECH_FUSION_CONFIDENCE_CEIL = "92"
TECH_FUSION_CAP_MIN = "0.15"
TECH_FUSION_CAP_MAX = "0.95"
TECH_FUSION_MAX_FACTOR_AGE_SEC = "90"
TECH_FUSION_RANGE_ONLY_SCORE = "0.45"
TECH_FUSION_TECH_FAILOPEN = "0"
TECH_FUSION_TECH_CONF_BOOST = "18.0"
TECH_FUSION_TECH_CONF_PENALTY = "10.0"
TECH_FUSION_TREND_SCORE_MIN = "0.6"
TECH_FUSION_RANGE_SCORE_MIN = "0.7"
TECH_FUSION_TREND_ADX_MIN = "18.0"
TECH_FUSION_RANGE_ADX_MAX = "18.0"
TECH_FUSION_RANGE_RSI_LONG = "35.0"
TECH_FUSION_RANGE_RSI_SHORT = "65.0"
TECH_FUSION_RANGE_BB_RATIO = "0.18"
TECH_FUSION_RANGE_BB_MIN_PIPS = "1.2"
TECH_FUSION_RANGE_BBW_MAX = "0.0018"
TECH_FUSION_SL_MIN_TREND = "8.0"
TECH_FUSION_SL_MAX_TREND = "35.0"
TECH_FUSION_SL_ATR_MULT_TREND = "2.0"
TECH_FUSION_TP_MIN_TREND = "12.0"
TECH_FUSION_TP_MAX_TREND = "60.0"
TECH_FUSION_TP_RR_TREND = "1.4"
TECH_FUSION_SL_MIN_RANGE = "4.0"
TECH_FUSION_SL_MAX_RANGE = "18.0"
TECH_FUSION_SL_ATR_MULT_RANGE = "1.3"
TECH_FUSION_TP_MIN_RANGE = "6.0"
TECH_FUSION_TP_MAX_RANGE = "24.0"
TECH_FUSION_TP_RR_RANGE = "1.0"
TECH_FUSION_SPREAD_FLOOR_PIPS = "12.0"
TECH_FUSION_EXIT_LOOP_INTERVAL_SEC = "0.8"
TECH_FUSION_EXIT_MIN_HOLD_SEC = "90"
TECH_FUSION_EXIT_MAX_HOLD_SEC = "1800"
TECH_FUSION_EXIT_PROFIT_PIPS = "10.0"
TECH_FUSION_EXIT_TRAIL_START_PIPS = "12.0"
TECH_FUSION_EXIT_TRAIL_BACKOFF_PIPS = "4.0"
TECH_FUSION_EXIT_LOCK_BUFFER_PIPS = "3.0"
TECH_FUSION_EXIT_LOCK_TRIGGER_PIPS = "6.0"
TECH_FUSION_EXIT_REV_WINDOW_SEC = "30.0"
TECH_FUSION_EXIT_REV_PIPS = "8.0"
TECH_FUSION_EXIT_ATR_SPIKE_PIPS = "12.0"
TECH_FUSION_EXIT_HARD_STOP_PIPS = "14.0"
TECH_FUSION_EXIT_TP_HINT_RATIO = "0.75"
# Macro Tech Fusion (trend)
MACRO_TECH_FUSION_ENABLED = "0"
MACRO_TECH_FUSION_LOOP_INTERVAL_SEC = "12.0"
MACRO_TECH_FUSION_BASE_ENTRY_UNITS = "40000"
MACRO_TECH_FUSION_MIN_UNITS = "2000"
MACRO_TECH_FUSION_CONFIDENCE_FLOOR = "45"
MACRO_TECH_FUSION_CONFIDENCE_CEIL = "92"
MACRO_TECH_FUSION_CAP_MIN = "0.2"
MACRO_TECH_FUSION_CAP_MAX = "0.95"
MACRO_TECH_FUSION_MAX_FACTOR_AGE_SEC = "180"
MACRO_TECH_FUSION_TREND_ADX_MIN = "20.0"
MACRO_TECH_FUSION_TREND_SCORE_MIN = "0.55"
MACRO_TECH_FUSION_RANGE_BLOCK = "1"
MACRO_TECH_FUSION_SL_MIN_PIPS = "20.0"
MACRO_TECH_FUSION_SL_MAX_PIPS = "60.0"
MACRO_TECH_FUSION_SL_ATR_MULT = "2.8"
MACRO_TECH_FUSION_TP_MIN_PIPS = "40.0"
MACRO_TECH_FUSION_TP_MAX_PIPS = "120.0"
MACRO_TECH_FUSION_TP_RR = "1.6"
MACRO_TECH_FUSION_SPREAD_FLOOR_PIPS = "16.0"
MACRO_TECH_FUSION_EXIT_LOOP_INTERVAL_SEC = "1.2"
MACRO_TECH_FUSION_EXIT_MIN_HOLD_SEC = "300"
MACRO_TECH_FUSION_EXIT_MAX_HOLD_SEC = "21600"
MACRO_TECH_FUSION_EXIT_PROFIT_PIPS = "20.0"
MACRO_TECH_FUSION_EXIT_TRAIL_START_PIPS = "28.0"
MACRO_TECH_FUSION_EXIT_TRAIL_BACKOFF_PIPS = "10.0"
MACRO_TECH_FUSION_EXIT_LOCK_BUFFER_PIPS = "8.0"
MACRO_TECH_FUSION_EXIT_LOCK_TRIGGER_PIPS = "14.0"
MACRO_TECH_FUSION_EXIT_REV_WINDOW_SEC = "120.0"
MACRO_TECH_FUSION_EXIT_REV_PIPS = "18.0"
MACRO_TECH_FUSION_EXIT_ATR_SPIKE_PIPS = "28.0"
MACRO_TECH_FUSION_EXIT_HARD_STOP_PIPS = "24.0"
MACRO_TECH_FUSION_EXIT_TP_HINT_RATIO = "0.75"
MACRO_TECH_FUSION_TECH_FAILOPEN = "0"
MACRO_TECH_FUSION_TECH_CONF_BOOST = "16.0"
MACRO_TECH_FUSION_TECH_CONF_PENALTY = "10.0"

# Micro Pullback-Fib (trend pullback)
MICRO_PULLBACK_FIB_ENABLED = "0"
MICRO_PULLBACK_FIB_LOOP_INTERVAL_SEC = "6.0"
MICRO_PULLBACK_FIB_BASE_ENTRY_UNITS = "20000"
MICRO_PULLBACK_FIB_MIN_UNITS = "1500"
MICRO_PULLBACK_FIB_CONFIDENCE_FLOOR = "40"
MICRO_PULLBACK_FIB_CONFIDENCE_CEIL = "92"
MICRO_PULLBACK_FIB_CAP_MIN = "0.15"
MICRO_PULLBACK_FIB_CAP_MAX = "0.95"
MICRO_PULLBACK_FIB_MAX_FACTOR_AGE_SEC = "90"
MICRO_PULLBACK_FIB_TREND_ADX_MIN = "16.0"
MICRO_PULLBACK_FIB_TREND_SCORE_MIN = "0.55"
MICRO_PULLBACK_FIB_RSI_MIN = "40.0"
MICRO_PULLBACK_FIB_RSI_MAX = "58.0"
MICRO_PULLBACK_FIB_MA_BUFFER_PIPS = "0.6"
MICRO_PULLBACK_FIB_SL_MIN_PIPS = "6.0"
MICRO_PULLBACK_FIB_SL_MAX_PIPS = "18.0"
MICRO_PULLBACK_FIB_SL_ATR_MULT = "1.6"
MICRO_PULLBACK_FIB_TP_MIN_PIPS = "10.0"
MICRO_PULLBACK_FIB_TP_MAX_PIPS = "30.0"
MICRO_PULLBACK_FIB_TP_RR = "1.5"
MICRO_PULLBACK_FIB_SPREAD_FLOOR_PIPS = "10.0"
MICRO_PULLBACK_FIB_EXIT_LOOP_INTERVAL_SEC = "0.9"
MICRO_PULLBACK_FIB_EXIT_MIN_HOLD_SEC = "120"
MICRO_PULLBACK_FIB_EXIT_MAX_HOLD_SEC = "1800"
MICRO_PULLBACK_FIB_EXIT_PROFIT_PIPS = "8.0"
MICRO_PULLBACK_FIB_EXIT_TRAIL_START_PIPS = "10.0"
MICRO_PULLBACK_FIB_EXIT_TRAIL_BACKOFF_PIPS = "3.5"
MICRO_PULLBACK_FIB_EXIT_LOCK_BUFFER_PIPS = "2.8"
MICRO_PULLBACK_FIB_EXIT_LOCK_TRIGGER_PIPS = "5.0"
MICRO_PULLBACK_FIB_EXIT_REV_WINDOW_SEC = "45.0"
MICRO_PULLBACK_FIB_EXIT_REV_PIPS = "7.0"
MICRO_PULLBACK_FIB_EXIT_ATR_SPIKE_PIPS = "12.0"
MICRO_PULLBACK_FIB_EXIT_HARD_STOP_PIPS = "12.0"
MICRO_PULLBACK_FIB_EXIT_TP_HINT_RATIO = "0.75"
MICRO_PULLBACK_FIB_TECH_FAILOPEN = "0"
MICRO_PULLBACK_FIB_TECH_CONF_BOOST = "18.0"
MICRO_PULLBACK_FIB_TECH_CONF_PENALTY = "10.0"

# Scalp Reversal-NWave
SCALP_REVERSAL_NWAVE_ENABLED = "0"
SCALP_REVERSAL_NWAVE_LOOP_INTERVAL_SEC = "0.8"
SCALP_REVERSAL_NWAVE_BASE_ENTRY_UNITS = "6000"
SCALP_REVERSAL_NWAVE_MIN_UNITS = "900"
SCALP_REVERSAL_NWAVE_CONFIDENCE_FLOOR = "38"
SCALP_REVERSAL_NWAVE_CONFIDENCE_CEIL = "90"
SCALP_REVERSAL_NWAVE_CAP_MIN = "0.12"
SCALP_REVERSAL_NWAVE_CAP_MAX = "0.85"
SCALP_REVERSAL_NWAVE_MAX_FACTOR_AGE_SEC = "45"
SCALP_REVERSAL_NWAVE_VWAP_GAP_MIN_PIPS = "3.5"
SCALP_REVERSAL_NWAVE_RSI_MIN_LONG = "32.0"
SCALP_REVERSAL_NWAVE_RSI_MAX_SHORT = "68.0"
SCALP_REVERSAL_NWAVE_SL_MIN_PIPS = "2.0"
SCALP_REVERSAL_NWAVE_SL_MAX_PIPS = "5.0"
SCALP_REVERSAL_NWAVE_SL_ATR_MULT = "1.1"
SCALP_REVERSAL_NWAVE_TP_MIN_PIPS = "3.0"
SCALP_REVERSAL_NWAVE_TP_MAX_PIPS = "7.0"
SCALP_REVERSAL_NWAVE_TP_RR = "1.3"
SCALP_REVERSAL_NWAVE_SPREAD_FLOOR_PIPS = "4.0"
SCALP_REVERSAL_NWAVE_EXIT_LOOP_INTERVAL_SEC = "0.5"
SCALP_REVERSAL_NWAVE_EXIT_MIN_HOLD_SEC = "12"
SCALP_REVERSAL_NWAVE_EXIT_MAX_HOLD_SEC = "180"
SCALP_REVERSAL_NWAVE_EXIT_PROFIT_PIPS = "3.0"
SCALP_REVERSAL_NWAVE_EXIT_TRAIL_START_PIPS = "3.8"
SCALP_REVERSAL_NWAVE_EXIT_TRAIL_BACKOFF_PIPS = "1.2"
SCALP_REVERSAL_NWAVE_EXIT_LOCK_BUFFER_PIPS = "0.9"
SCALP_REVERSAL_NWAVE_EXIT_LOCK_TRIGGER_PIPS = "1.8"
SCALP_REVERSAL_NWAVE_EXIT_REV_WINDOW_SEC = "6.0"
SCALP_REVERSAL_NWAVE_EXIT_REV_PIPS = "3.2"
SCALP_REVERSAL_NWAVE_EXIT_ATR_SPIKE_PIPS = "6.0"
SCALP_REVERSAL_NWAVE_EXIT_HARD_STOP_PIPS = "6.0"
SCALP_REVERSAL_NWAVE_EXIT_TP_HINT_RATIO = "0.75"
SCALP_REVERSAL_NWAVE_TECH_FAILOPEN = "0"
SCALP_REVERSAL_NWAVE_TECH_CONF_BOOST = "16.0"
SCALP_REVERSAL_NWAVE_TECH_CONF_PENALTY = "10.0"

# Range Compression Break
RANGE_COMPRESSION_BREAK_ENABLED = "0"
RANGE_COMPRESSION_BREAK_LOOP_INTERVAL_SEC = "6.0"
RANGE_COMPRESSION_BREAK_BASE_ENTRY_UNITS = "20000"
RANGE_COMPRESSION_BREAK_MIN_UNITS = "1500"
RANGE_COMPRESSION_BREAK_CONFIDENCE_FLOOR = "40"
RANGE_COMPRESSION_BREAK_CONFIDENCE_CEIL = "92"
RANGE_COMPRESSION_BREAK_CAP_MIN = "0.15"
RANGE_COMPRESSION_BREAK_CAP_MAX = "0.95"
RANGE_COMPRESSION_BREAK_MAX_FACTOR_AGE_SEC = "90"
RANGE_COMPRESSION_BREAK_BBW_MAX = "0.0018"
RANGE_COMPRESSION_BREAK_KC_WIDTH_MAX = "0.012"
RANGE_COMPRESSION_BREAK_DONCHIAN_WIDTH_MAX = "0.012"
RANGE_COMPRESSION_BREAK_ADX_MAX = "18.0"
RANGE_COMPRESSION_BREAK_NWAVE_MIN_QUALITY = "0.2"
RANGE_COMPRESSION_BREAK_NWAVE_MIN_LEG_PIPS = "3.0"
RANGE_COMPRESSION_BREAK_DONCHIAN_LOOKBACK = "20"
RANGE_COMPRESSION_BREAK_DONCHIAN_NEAR_PIPS = "4.0"
RANGE_COMPRESSION_BREAK_SL_MIN_PIPS = "6.0"
RANGE_COMPRESSION_BREAK_SL_MAX_PIPS = "16.0"
RANGE_COMPRESSION_BREAK_SL_ATR_MULT = "1.8"
RANGE_COMPRESSION_BREAK_TP_MIN_PIPS = "12.0"
RANGE_COMPRESSION_BREAK_TP_MAX_PIPS = "32.0"
RANGE_COMPRESSION_BREAK_TP_RR = "1.6"
RANGE_COMPRESSION_BREAK_SPREAD_FLOOR_PIPS = "10.0"
RANGE_COMPRESSION_BREAK_EXIT_LOOP_INTERVAL_SEC = "0.9"
RANGE_COMPRESSION_BREAK_EXIT_MIN_HOLD_SEC = "120"
RANGE_COMPRESSION_BREAK_EXIT_MAX_HOLD_SEC = "1800"
RANGE_COMPRESSION_BREAK_EXIT_PROFIT_PIPS = "10.0"
RANGE_COMPRESSION_BREAK_EXIT_TRAIL_START_PIPS = "12.0"
RANGE_COMPRESSION_BREAK_EXIT_TRAIL_BACKOFF_PIPS = "4.0"
RANGE_COMPRESSION_BREAK_EXIT_LOCK_BUFFER_PIPS = "3.0"
RANGE_COMPRESSION_BREAK_EXIT_LOCK_TRIGGER_PIPS = "6.0"
RANGE_COMPRESSION_BREAK_EXIT_REV_WINDOW_SEC = "45.0"
RANGE_COMPRESSION_BREAK_EXIT_REV_PIPS = "8.0"
RANGE_COMPRESSION_BREAK_EXIT_ATR_SPIKE_PIPS = "12.0"
RANGE_COMPRESSION_BREAK_EXIT_HARD_STOP_PIPS = "12.0"
RANGE_COMPRESSION_BREAK_EXIT_TP_HINT_RATIO = "0.75"
RANGE_COMPRESSION_BREAK_TECH_FAILOPEN = "0"
RANGE_COMPRESSION_BREAK_TECH_CONF_BOOST = "18.0"
RANGE_COMPRESSION_BREAK_TECH_CONF_PENALTY = "10.0"
# Aggressive mode: 1 でレンジ抑制と micro ゲート/クールダウン解除
AGGRESSIVE_TRADING = "1"
# Macro汎用フォールバックEXIT無効化（戦略TP/SL優先）
EXIT_DISABLE_MACRO_FALLBACK = "true"
# Pocket別 EXIT ワーカー利用時に main 側の EXIT を無効化するポケット（カンマ区切り）
EXIT_MAIN_DISABLE_POCKETS = ""
EXIT_MAIN_DISABLE_MICRO = "false"
# --- Exit guard (negative close) ---
EXIT_NO_NEGATIVE_CLOSE = "1"
EXIT_TECH_GUARD_ENABLED = "1"
EXIT_TECH_GUARD_FAILOPEN = "0"
EXIT_ALLOW_NEGATIVE_BY_WORKER = "0"
EXIT_ALLOW_NEGATIVE_REASONS = "hard_stop,tech_hard_stop,time_stop,max_adverse,max_hold,structure_break,atr_spike,rsi_fade,vwap_cut,tech_exit,range_timeout,drawdown,max_drawdown,health_exit,hazard_exit,margin_health,free_margin_low,margin_usage_high"
EXIT_ALLOW_NEGATIVE_NEAR_BE_PIPS = "0.6"
EXIT_ALLOW_NEGATIVE_NEAR_BE_REASONS = "lock_floor,trail_lock,profit_lock,trail_backoff,lock_trail,near_be,mtf_reversal"
EXIT_HOLD_UNTIL_PROFIT_ENABLED = "1"
EXIT_HOLD_UNTIL_PROFIT_CLIENT_IDS = ""
EXIT_HOLD_UNTIL_PROFIT_TRADE_IDS = ""
EXIT_HOLD_UNTIL_PROFIT_MIN_PIPS = "0.0"
EXIT_HOLD_UNTIL_PROFIT_STRICT = "0"
# Rollout gate: when set, scalp_precision negative exits apply only to trades opened
# at/after this timestamp (Unix sec/ms or ISO8601). Empty/0 disables the gate.
SCALP_PRECISION_EXIT_POLICY_START_TS = ""
# Rollout gate for M1Scalper exit worker (same format as above).
M1SCALP_EXIT_POLICY_START_TS = ""
EXIT_COMPOSITE_MIN_SCORE = "4"
TECH_EXIT_STRICT = "1"
TECH_EXIT_REQUIRE_COVERAGE = "1"
TECH_EXIT_REQUIRE_MTF_TRIAD = "1"
TECH_EXIT_REQUIRE_FIB = "1"
TECH_EXIT_REQUIRE_MEDIAN = "1"
TECH_EXIT_REQUIRE_NWAVE = "1"
TECH_EXIT_REQUIRE_CANDLE = "1"
TECH_EXIT_PIVOT_FAILOPEN = "0"
TECH_EXIT_MOMENTUM_FAILOPEN = "0"
TECH_EXIT_MIN_COVERAGE = "0.85"
TECH_EXIT_MOMENTUM_MIN_SCORE_SCALP = "0.42"
TECH_EXIT_MOMENTUM_MIN_SCORE_MICRO = "0.45"
TECH_EXIT_MOMENTUM_MIN_SCORE_MACRO = "0.40"
TECH_EXIT_MOMENTUM_BYPASS_M1SCALPER = "0"
TECH_EXIT_PIVOT_MIN_PIPS_SCALP = "1.2"
TECH_EXIT_PIVOT_MIN_PIPS_MICRO = "2.0"
TECH_EXIT_PIVOT_MIN_PIPS_MACRO = "3.5"
# --- TP cap (momentum adaptive) ---
ORDER_TP_CAP_ENABLED = "1"
ORDER_TP_CAP_DYNAMIC_ENABLED = "1"
ORDER_TP_CAP_SCALP = "10.0"
ORDER_TP_CAP_SCALP_FAST = "5.0"
ORDER_TP_CAP_MICRO = "20.0"
ORDER_TP_CAP_MACRO = "40.0"
ORDER_TP_CAP_MANUAL = "0.0"
ORDER_TP_CAP_MULT_MIN = "0.8"
ORDER_TP_CAP_MULT_MAX = "1.6"
ORDER_TP_CAP_WEIGHT_TREND = "0.6"
ORDER_TP_CAP_WEIGHT_VOL = "0.4"
ORDER_TP_CAP_ADX_LOW_SCALP = "18.0"
ORDER_TP_CAP_ADX_HIGH_SCALP = "35.0"
ORDER_TP_CAP_ATR_LOW_SCALP = "6.0"
ORDER_TP_CAP_ATR_HIGH_SCALP = "14.0"
ORDER_TP_CAP_ADX_LOW_MICRO = "16.0"
ORDER_TP_CAP_ADX_HIGH_MICRO = "30.0"
ORDER_TP_CAP_ATR_LOW_MICRO = "8.0"
ORDER_TP_CAP_ATR_HIGH_MICRO = "20.0"
ORDER_TP_CAP_ADX_LOW_MACRO = "18.0"
ORDER_TP_CAP_ADX_HIGH_MACRO = "32.0"
ORDER_TP_CAP_ATR_LOW_MACRO = "12.0"
ORDER_TP_CAP_ATR_HIGH_MACRO = "28.0"
# --- Exit momentum scaling ---
EXIT_MOMENTUM_SCALE_ENABLED = "1"
EXIT_MOMENTUM_SCALE_LOG = "0"
EXIT_MOMENTUM_INVERT_REVERSAL = "1"
EXIT_MOMENTUM_MULT_MIN = "1.0"
EXIT_MOMENTUM_MULT_MAX = "1.6"
EXIT_MOMENTUM_WEIGHT_TREND = "0.6"
EXIT_MOMENTUM_WEIGHT_VOL = "0.4"
EXIT_MOMENTUM_RANGE_MULT = "1.0"
EXIT_MOMENTUM_TF_SCALP = "M1"
EXIT_MOMENTUM_TF_SCALP_FAST = "M1"
EXIT_MOMENTUM_TF_MICRO = "M5"
EXIT_MOMENTUM_TF_MACRO = "H1"
EXIT_MOMENTUM_ADX_LOW_SCALP = "18.0"
EXIT_MOMENTUM_ADX_HIGH_SCALP = "35.0"
EXIT_MOMENTUM_ATR_LOW_SCALP = "6.0"
EXIT_MOMENTUM_ATR_HIGH_SCALP = "14.0"
EXIT_MOMENTUM_ADX_LOW_MICRO = "16.0"
EXIT_MOMENTUM_ADX_HIGH_MICRO = "30.0"
EXIT_MOMENTUM_ATR_LOW_MICRO = "8.0"
EXIT_MOMENTUM_ATR_HIGH_MICRO = "20.0"
EXIT_MOMENTUM_ADX_LOW_MACRO = "18.0"
EXIT_MOMENTUM_ADX_HIGH_MACRO = "32.0"
EXIT_MOMENTUM_ATR_LOW_MACRO = "12.0"
EXIT_MOMENTUM_ATR_HIGH_MACRO = "28.0"
# Fast-cut (time-stop/MAE) guard in section-axis exits
SECTION_EXIT_FAST_CUT_ENABLED = "true"
# 全ポケットの取引一時停止（1 で停止、0で再開）
TRADING_PAUSED = "0"
# Fast scalp worker (disable to avoid non-exit closes)
FAST_SCALP_ENABLED = "0"
# 5s ping scalp worker (hedge-trap recovery)
SCALP_PING_5S_ENABLED = "0"
SCALP_PING_5S_REQUIRE_PRACTICE = "1"
SCALP_PING_5S_POCKET = "scalp_fast"
SCALP_PING_5S_STRATEGY_TAG = "scalp_ping_5s"
SCALP_PING_5S_ENV_PREFIX = "SCALP_PING_5S"
SCALP_PING_5S_NO_HEDGE_ENTRY = "0"
SCALP_PING_5S_TRAP_BYPASS_NO_HEDGE = "1"
SCALP_PING_5S_TRAP_REQUIRE_NET_LOSS = "1"
SCALP_PING_5S_TRAP_MIN_LONG_UNITS = "8000"
SCALP_PING_5S_TRAP_MIN_SHORT_UNITS = "8000"
SCALP_PING_5S_TRAP_MAX_NET_RATIO = "0.45"
SCALP_PING_5S_TRAP_MIN_COMBINED_DD_PIPS = "0.8"
SCALP_PING_5S_MAX_SPREAD_PIPS = "0.35"
SCALP_PING_5S_ENTRY_BID_ASK_EDGE_PIPS = "0.12"
SCALP_PING_5S_WINDOW_SEC = "5.0"
SCALP_PING_5S_SIGNAL_WINDOW_SEC = "1.2"
SCALP_PING_5S_SIGNAL_WINDOW_FALLBACK_SEC = "0.0"
SCALP_PING_5S_SIGNAL_WINDOW_FALLBACK_ALLOW_FULL_WINDOW = "1"
SCALP_PING_5S_SIGNAL_WINDOW_ADAPTIVE_ENABLED = "0"
SCALP_PING_5S_SIGNAL_WINDOW_ADAPTIVE_SHADOW_ENABLED = "1"
SCALP_PING_5S_SIGNAL_WINDOW_ADAPTIVE_CANDIDATES_SEC = "0.4,0.78,1.2,1.5,2.0,2.857,8.0"
SCALP_PING_5S_SIGNAL_WINDOW_ADAPTIVE_SCALE_WITH_SPEED = "1"
SCALP_PING_5S_SIGNAL_WINDOW_ADAPTIVE_MIN_SEC = "0.3"
SCALP_PING_5S_SIGNAL_WINDOW_ADAPTIVE_MAX_SEC = "8.0"
SCALP_PING_5S_SIGNAL_WINDOW_ADAPTIVE_STATS_TTL_SEC = "25"
SCALP_PING_5S_SIGNAL_WINDOW_ADAPTIVE_LOOKBACK_HOURS = "48"
SCALP_PING_5S_SIGNAL_WINDOW_ADAPTIVE_MIN_TRADES = "30"
SCALP_PING_5S_SIGNAL_WINDOW_ADAPTIVE_MATCH_TOL_SEC = "0.35"
SCALP_PING_5S_SIGNAL_WINDOW_ADAPTIVE_BUCKET_SEC = "0.05"
SCALP_PING_5S_SIGNAL_WINDOW_ADAPTIVE_UCB_BONUS_PIPS = "0.12"
SCALP_PING_5S_SIGNAL_WINDOW_ADAPTIVE_COLDSTART_PENALTY_PIPS = "0.20"
SCALP_PING_5S_SIGNAL_WINDOW_ADAPTIVE_SELECTION_MARGIN_PIPS = "0.05"
SCALP_PING_5S_SIGNAL_WINDOW_ADAPTIVE_SHADOW_LOG_INTERVAL_SEC = "15"
SCALP_PING_5S_ENTRY_COOLDOWN_SEC = "1.0"
SCALP_PING_5S_TP_BASE_PIPS = "0.30"
SCALP_PING_5S_TP_NET_MIN_PIPS = "0.30"
SCALP_PING_5S_TP_MAX_PIPS = "0.80"
SCALP_PING_5S_TP_NET_MIN_FLOOR_PIPS = "0.12"
SCALP_PING_5S_SL_BASE_PIPS = "1.40"
SCALP_PING_5S_SL_MIN_PIPS = "1.00"
SCALP_PING_5S_SL_MAX_PIPS = "4.20"
SCALP_PING_5S_SL_SPREAD_MULT = "1.2"
SCALP_PING_5S_SL_SPREAD_BUFFER_PIPS = "0.30"
SCALP_PING_5S_USE_SL = "0"
SCALP_PING_5S_DISABLE_ENTRY_HARD_STOP = "1"
SCALP_PING_5S_FORCE_EXIT_MAX_HOLD_SEC = "150"
SCALP_PING_5S_FORCE_EXIT_MAX_FLOATING_LOSS_PIPS = "3.5"
SCALP_PING_5S_FORCE_EXIT_BID_ASK_BUFFER_PIPS = "0.08"
SCALP_PING_5S_MAX_ORDERS_PER_MINUTE = "36"
SCALP_PING_5S_MAX_ACTIVE_TRADES = "6"
SCALP_PING_5S_MAX_PER_DIRECTION = "3"
SCALP_PING_5S_DIRECTION_BIAS_ENABLED = "1"
SCALP_PING_5S_DIRECTION_BIAS_WINDOW_SEC = "20"
SCALP_PING_5S_DIRECTION_BIAS_MIN_TICKS = "24"
SCALP_PING_5S_DIRECTION_BIAS_NEUTRAL_SCORE = "0.18"
SCALP_PING_5S_DIRECTION_BIAS_BLOCK_SCORE = "0.58"
SCALP_PING_5S_DIRECTION_BIAS_ALIGN_SCORE_MIN = "0.40"
SCALP_PING_5S_DIRECTION_BIAS_OPPOSITE_UNITS_MULT = "0.72"
SCALP_PING_5S_DIRECTION_BIAS_ALIGN_UNITS_BOOST_MAX = "0.20"
SCALP_PING_5S_DIRECTION_BIAS_VOL_LOW_PIPS = "0.40"
SCALP_PING_5S_DIRECTION_BIAS_VOL_HIGH_PIPS = "2.40"
SCALP_PING_5S_DIRECTION_BIAS_LOG_INTERVAL_SEC = "8"
SCALP_PING_5S_REVERT_ENABLED = "1"
SCALP_PING_5S_REVERT_WINDOW_SEC = "2.8"
SCALP_PING_5S_REVERT_SHORT_WINDOW_SEC = "0.8"
SCALP_PING_5S_REVERT_MIN_TICKS = "8"
SCALP_PING_5S_REVERT_MIN_TICK_RATE = "4.0"
SCALP_PING_5S_REVERT_RANGE_MIN_PIPS = "0.9"
SCALP_PING_5S_REVERT_SWEEP_MIN_PIPS = "0.55"
SCALP_PING_5S_REVERT_BOUNCE_MIN_PIPS = "0.20"
SCALP_PING_5S_REVERT_CONFIRM_TICKS = "6"
SCALP_PING_5S_REVERT_CONFIRM_RATIO_MIN = "0.60"
SCALP_PING_5S_MODE_SWITCH_REVERT_DOMINANCE = "1.08"
SCALP_PING_5S_REVERT_DIRECTION_HARD_BLOCK_SCORE = "0.82"
SCALP_PING_5S_REVERT_DIRECTION_OPPOSITE_UNITS_MULT = "0.86"
SCALP_PING_5S_REVERT_SIDE_BIAS_PENALTY_WEIGHT = "0.45"
SCALP_PING_5S_REVERT_SIDE_BIAS_FLOOR = "0.55"
# Macro H1Momentum worker
H1M_ENABLED = "0"
# H1Momentum regime/volatility guard
H1M_REGIME_GUARD_ENABLED = "1"
H1M_REQUIRE_MACRO_TREND = "1"
H1M_BLOCK_MICRO_RANGE = "1"
H1M_MIN_ATR_PIPS = "1.2"
# H1Momentum candlestick entry guard (H1)
H1M_CANDLE_GUARD_ENABLED = "1"
H1M_CANDLE_DIR_REQUIRED = "1"
H1M_CANDLE_DIR_MIN_BODY_PIPS = "2.0"
H1M_CANDLE_MAX_RANGE_PIPS = "90.0"
# H1Momentum multi-timeframe guard (H4 alignment + D1 veto)
H1M_MTF_ENABLED = "1"
H1M_MTF_H4_REQUIRED = "1"
H1M_MTF_H4_MIN_GAP_PIPS = "1.6"
H1M_MTF_D1_VETO = "1"
H1M_MTF_D1_MIN_GAP_PIPS = "3.5"
H1M_MTF_D1_MIN_ADX = "20.0"
# H1Momentum exit guards (H1 candle + MTF)
H1MOMENTUM_EXIT_MTF_ENABLED = "1"
H1MOMENTUM_EXIT_CANDLE_ENABLED = "1"
H1MOMENTUM_EXIT_CANDLE_MIN_BODY_PIPS = "6.0"
H1MOMENTUM_EXIT_CANDLE_MIN_RANGE_PIPS = "30.0"
H1MOMENTUM_EXIT_CANDLE_MIN_BODY_RATIO = "0.45"
# Donchian55 regime guard
DON55_REGIME_GUARD_ENABLED = "1"
DON55_REGIME_COMBO_GUARD_ENABLED = "1"
# Legacy manual swing worker (disable to avoid cross-pocket exits)
MANUAL_SWING_ENABLED = "0"

# perf_monitor (pocket PF snapshot; SQL aggregate + TTL)
PERF_MONITOR_TTL_SEC = "300"
PERF_MONITOR_STRATEGY_TTL_SEC = "300"

# Performance guard (PF/勝率の悪化でブロック)
PERF_GUARD_GLOBAL_ENABLED = "1"
PERF_GUARD_ENABLED = "1"
PERF_GUARD_MODE = "block"
PERF_GUARD_LOOKBACK_DAYS = "14"
PERF_GUARD_MIN_TRADES = "10"
PERF_GUARD_METRIC = "realized_pl"          # realized_pl | net_pl | pips
PERF_GUARD_PF_MIN = "0.9"
PERF_GUARD_WIN_MIN = "0.48"
PERF_GUARD_PF_MIN_SCALP = "0.9"
PERF_GUARD_PF_MIN_MICRO = "0.9"
PERF_GUARD_PF_MIN_MACRO = "0.9"
PERF_GUARD_WIN_MIN_SCALP = "0.48"
PERF_GUARD_WIN_MIN_MICRO = "0.48"
PERF_GUARD_WIN_MIN_MACRO = "0.48"
PERF_GUARD_TTL_SEC = "120"
PERF_GUARD_HOURLY = "0"
PERF_GUARD_HOURLY_MIN_TRADES = "12"
PERF_GUARD_RELAX_TAGS = ""
PERF_GUARD_SPLIT_DIRECTIONAL = "1"
POCKET_PERF_GUARD_ENABLED = "0"
POCKET_PERF_GUARD_LOOKBACK_DAYS = "7"
POCKET_PERF_GUARD_MIN_TRADES = "60"
POCKET_PERF_GUARD_PF_MIN = "0.95"
POCKET_PERF_GUARD_WIN_MIN = "0.50"
POCKET_PERF_GUARD_PF_MIN_MICRO = "0.92"
POCKET_PERF_GUARD_WIN_MIN_MICRO = "0.48"
POCKET_PERF_GUARD_TTL_SEC = "180"
POCKET_PERF_GUARD_METRIC = "realized_pl"    # realized_pl | net_pl | pips

# Profit giveback guard (recent peak -> drawdown lock)
PROFIT_GUARD_ENABLED = "0"
PROFIT_GUARD_MODE = "block"
PROFIT_GUARD_POCKETS = "scalp"
PROFIT_GUARD_LOOKBACK_MIN = "180"
PROFIT_GUARD_MIN_PEAK_PIPS = "6"
PROFIT_GUARD_MAX_GIVEBACK_PIPS = "3"
PROFIT_GUARD_MIN_PEAK_JPY = "0"
PROFIT_GUARD_MAX_GIVEBACK_JPY = "0"
PROFIT_GUARD_TTL_SEC = "30"

# Spread guard settings
spread_guard_max_pips = "1.4"
spread_guard_release_pips = "1.1"
spread_guard_window_sec = "4.5"
spread_guard_cooldown_sec = "25"
spread_guard_min_high_samples = "3"
spread_guard_release_samples = "4"
spread_guard_max_age_ms = "4000"
spread_guard_baseline_window_sec = "300"
spread_guard_baseline_min_samples = "60"
FAST_SCALP_OFF_HOURS_ENABLED = "0"
FAST_SCALP_SESSION_BIAS_ENABLED = "0"

# Daily maintenance window (UTC)
DAILY_HALT_ENABLED = "1"
DAILY_HALT_START_UTC = "21:58"
DAILY_HALT_END_UTC = "22:07"

# Data lag watchdog (tick遅延が続く場合に stream リセット or main 再起動)
DATA_LAG_RESTART_MS = "8000"
DATA_LAG_RESTART_STRIKES = "3"
STREAM_RECOVERY_MODE = "stream"  # stream|restart
STREAM_RESET_COOLDOWN_SEC = "30"

# Tick stream idle reconnect guard
TICK_STREAM_READ_TIMEOUT_SEC = "25"
TICK_STREAM_MAX_IDLE_SEC = "20"
TICK_STREAM_MAX_IDLE_STRIKES = "3"
TICK_STREAM_IDLE_IGNORE_CLOSED = "1"

# Tick silence watchdog (no tick for N seconds -> stream reset or restart)
TICK_SILENCE_RESTART_SEC = "20"
TICK_SILENCE_RESTART_STRIKES = "3"
TICK_SILENCE_GRACE_SEC = "120"

# Exit: hold until profit (optional global override)
EXIT_HOLD_UNTIL_PROFIT_ALL = "0"

# Position manager (open trades cache)
POSITION_MANAGER_OPEN_TRADES_CACHE_TTL = "5.0"

# Worker autcontrol (logic loop 内で systemctl を叩く場合のみ 1)
WORKER_AUTOCONTROL_IN_LOGIC = "0"

# Health snapshot (GCS object path)
HEALTH_OBJECT_PATH = "realtime/health_fx-trader-vm.json"

[macro_state]
snapshot_path = "fixtures/macro_snapshots/latest.json"
deadzone = "0.25"
gate_enabled = "false"

[event_window]
enabled = "true"
hours_before = "2"
hours_after = "1"
risk_multiplier = "0.3"

[exposure]
usd_long_max_lot = "2.5"


# --- Air / microstructure gating ---
AIR_ENABLED = "0"
AIR_TICK_WINDOW_SEC = "6.0"
AIR_TICK_MIN_SAMPLES = "12"
AIR_TICK_RATE_REF = "2.5"
AIR_VELOCITY_REF_PPS = "0.35"
AIR_IMBALANCE_MIN = "0.58"
AIR_SPREAD_TIGHT_PIPS = "0.9"
AIR_SPREAD_WIDE_PIPS = "1.4"
AIR_SPREAD_BLOCK_WIDE = "1"
AIR_EXEC_STALE_MS = "3000"
AIR_EXEC_HARD_BLOCK_MS = "5000"
AIR_EXEC_MIN_QUALITY = "0.35"
AIR_EXEC_MIN_TICK_RATE = "0.8"
AIR_RANGE_PREF_HIGH = "0.62"
AIR_RANGE_PREF_LOW = "0.42"
AIR_SIZE_MIN = "0.65"
AIR_SIZE_MAX = "1.25"
AIR_LOG_ENABLED = "0"
AIR_LOG_INTERVAL_SEC = "15"

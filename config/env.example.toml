gcp_location = "asia-northeast1"
gcp_project_id = "your-project-id"
gcp_pubsub_topic = "quant-topic"
ui_bucket_name = "fx-ui-realtime"
ui_state_object_path = "realtime/ui_state.json"
ui_service_account_email = "ui-dashboard-sa@quantrabbit.iam.gserviceaccount.com"
AUTOTUNE_BQ_TABLE = "quantrabbit.autotune_runs"
AUTOTUNE_BQ_SETTINGS_TABLE = "quantrabbit.autotune_settings"

oanda_account_id = "000-000-00000000-000"
oanda_token = "replace-with-your-token"
oanda_practice = "true"
oanda_hedging_enabled = "true"  # allow offsetting long/short positions

openai_api_key = "sk-test-placeholder"
openai_model = "gpt-4o-mini"
openai_model_decider = "gpt-5-mini"
openai_model_summarizer = "gpt-4o-mini"
openai_max_month_tokens = "300000"
tradingeconomics_api_key = "client:secret"  # format: <client>:<secret>

# BigQuery (Looker Studio / 集計用)
BQ_PROJECT = "your-project-id"          # 省略時は GOOGLE_CLOUD_PROJECT を使用
BQ_DATASET = "quantrabbit"              # bq_exporter の既定に合わせる
BQ_TRADES_TABLE = "trades_raw"          # bq_exporter の既定
BQ_LOCATION = "asia-northeast1"

# Firestore (strategy score snapshot)
FIRESTORE_PROJECT = "your-project-id"   # 省略時は BQ_PROJECT / GCP_PROJECT を利用
FIRESTORE_COLLECTION = "strategy_scores"
FIRESTORE_DOCUMENT = "current"
FIRESTORE_STRATEGY_ENABLE = "false"     # VM 側で Firestore 戦略スコアを読む場合のみ true
FIRESTORE_STRATEGY_TTL_SEC = "60"       # VM 読み取りキャッシュ TTL（秒）
FIRESTORE_STRATEGY_APPLY_SLTP = "false" # SL/TP 推奨値を適用するなら true（初期は無効）

# Level map (price buckets / reversal map)
LEVEL_MAP_ENABLE = "false"              # level_map.json を読む場合のみ true（初期は無効）
LEVEL_MAP_TTL_SEC = "300"
LEVEL_MAP_OBJECT_PATH = "analytics/level_map.json"

# --- Risk & sizing ---
# 1 トレードあたりの許容リスク割合（equity 比）。例: 0.01 = 1%
risk_pct = "0.025"
# マルチポケット合流時の最大リスク割合（base〜max で自動調整）
risk_pct_max = "0.1"
# 使用可能証拠金に対する最大使用割合（0.0〜1.0）
max_margin_usage = "0.92"
# Pocketごとの最小ロット/units（SL無し運用時のスキップ防止用）
RISK_MIN_LOT_SCALP = "0.10"          # 10k units
ORDER_MIN_UNITS_SCALP = "10000"
ORDER_MIN_UNITS_MACRO = "2000"
ORDER_MIN_UNITS_MICRO = "1000"
# Scalp worker minimums (override defaults as needed)
M1SCALP_MIN_UNITS = "1000"
SCALP_MULTI_MIN_UNITS = "1000"
M1SCALP_BASE_UNITS = "6000"
SCALP_MULTI_BASE_UNITS = "6000"
# Aggressive mode: 1 でレンジ抑制と micro ゲート/クールダウン解除
AGGRESSIVE_TRADING = "1"
# Macro汎用フォールバックEXIT無効化（戦略TP/SL優先）
EXIT_DISABLE_MACRO_FALLBACK = "true"
# Pocket別 EXIT ワーカー利用時に main 側の EXIT を無効化するポケット（カンマ区切り）
EXIT_MAIN_DISABLE_POCKETS = ""
EXIT_MAIN_DISABLE_MICRO = "false"
# 全ポケットの取引一時停止（1 で停止、0で再開）
TRADING_PAUSED = "0"

# Performance guard (PF/勝率の悪化でブロック)
PERF_GUARD_GLOBAL_ENABLED = "1"
PERF_GUARD_ENABLED = "1"
PERF_GUARD_LOOKBACK_DAYS = "14"
PERF_GUARD_MIN_TRADES = "10"
PERF_GUARD_PF_MIN = "0.9"
PERF_GUARD_WIN_MIN = "0.48"
PERF_GUARD_TTL_SEC = "120"
PERF_GUARD_HOURLY = "0"
PERF_GUARD_HOURLY_MIN_TRADES = "12"

# Entry guard (range/fib)
# フィボ上限判定を緩めてトレンド継続を許容
ENTRY_GUARD_FIB_EXTREME_SCALP = "0.18"
ENTRY_GUARD_FIB_EXTREME_SCALP_FAST = "0.18"
ENTRY_GUARD_FIB_EXTREME_MICRO = "0.20"
ENTRY_GUARD_FIB_EXTREME_MACRO = "0.20"
ENTRY_GUARD_FIB_EXTREME_TRENDMABEAR = "0.15"
ENTRY_GUARD_FIB_EXTREME_DONCHIAN55BREAKOUTDOWN = "0.15"
# 中央乖離の許容距離を拡大（mid_far ブロック抑制）
ENTRY_GUARD_MID_DISTANCE_PIPS_SCALP = "2.0"
ENTRY_GUARD_MID_DISTANCE_PIPS_SCALP_FAST = "1.8"
ENTRY_GUARD_MID_DISTANCE_PIPS_MICRO = "6.0"
ENTRY_GUARD_MID_DISTANCE_PIPS_MACRO = "12.0"
ENTRY_GUARD_MID_DISTANCE_FRAC_SCALP = "0.30"
ENTRY_GUARD_MID_DISTANCE_FRAC_SCALP_FAST = "0.30"
ENTRY_GUARD_MID_DISTANCE_FRAC_MICRO = "0.25"
ENTRY_GUARD_MID_DISTANCE_FRAC_MACRO = "0.25"
# soft allow を通しやすく（過度な拒否を緩和）
ENTRY_GUARD_SOFT_MIN_PENALTIES = "3"
ENTRY_GUARD_MOMENTUM_MIN_SCALP = "0.003"
ENTRY_GUARD_MOMENTUM_MIN_SCALP_FAST = "0.003"
ENTRY_GUARD_MOMENTUM_MIN_MICRO = "0.002"
ENTRY_GUARD_MOMENTUM_MIN_MACRO = "0.0015"
ENTRY_GUARD_VOL_5M_MIN_SCALP = "0.7"
ENTRY_GUARD_VOL_5M_MIN_SCALP_FAST = "0.7"
ENTRY_GUARD_VOL_5M_MIN_MICRO = "0.6"
ENTRY_GUARD_VOL_5M_MIN_MACRO = "0.5"

# Entry guard (MTF / strategy gates)
ENTRY_GUARD_TFS_M1SCALPER = "M1,H1"
ENTRY_GUARD_TFS_DONCHIAN5 = "M1,H1,H4"
ENTRY_GUARD_TFS_TRENDMABU = "M1,H1,H4"
ENTRY_GUARD_TFS_MOMENTUMB = "M1,H1"
ENTRY_GUARD_TFS_MOMENTUMP = "M1,H1,H4"
ENTRY_GUARD_TFS_IMPULSERE = "M1,H1,H4"

ENTRY_GUARD_ALIGN_MIN_DONCHIAN5 = "2"
ENTRY_GUARD_ALIGN_MIN_M1SCALPER = "1"
ENTRY_GUARD_ALIGN_MIN_MOMENTUMB = "2"
ENTRY_GUARD_ALIGN_MIN_MOMENTUMP = "3"
ENTRY_GUARD_ALIGN_MIN_IMPULSERE = "1"

# M1 過熱除外（スカルプ）
ENTRY_GUARD_OVERHEAT_BLOCK_M1SCALPER = "1"
ENTRY_GUARD_RSI_HIGH_M1SCALPER = "65"
ENTRY_GUARD_RSI_LOW_M1SCALPER = "35"

# MA20 距離（ATR）上限
ENTRY_GUARD_MA20_GAP_ATR_MAX_TRENDMA = "1.2"
ENTRY_GUARD_MA20_GAP_TF_TRENDMA = "M1"
ENTRY_GUARD_MA20_GAP_ATR_MAX_TRENDMABU = "1.2"
ENTRY_GUARD_MA20_GAP_TF_TRENDMABU = "M1"

# ADX レンジ制約
ENTRY_GUARD_ADX_RANGE_MIN_IMPULSERE = "20"
ENTRY_GUARD_ADX_RANGE_MAX_IMPULSERE = "0"
ENTRY_GUARD_ADX_TF_IMPULSERE = "H4"

# Trend bypass ADX 最小（strategy 別）
ENTRY_GUARD_TREND_ADX_MIN_TRENDMABULL = "18.0"
ENTRY_GUARD_TREND_ADX_MIN_TRENDMABEAR = "13.0"
ENTRY_GUARD_TREND_ADX_MIN_DONCHIAN55BREAKOUTUP = "14.5"
ENTRY_GUARD_TREND_ADX_MIN_DONCHIAN55BREAKOUTDOWN = "13.0"
ENTRY_GUARD_TREND_ADX_MIN_MOMENTUMBURSTOPENLONG = "19.5"
ENTRY_GUARD_TREND_ADX_MIN_MICROPULLBACKEMA = "18.0"

# MTF confirm (primary OK = allow, primary NG -> multi-TF confirm)
ENTRY_GUARD_MTF_ENABLED = "1"
ENTRY_GUARD_MTF_MIN_BLOCKS = "2"
ENTRY_GUARD_TFS_SCALP = "M1,M5"
ENTRY_GUARD_TFS_SCALP_FAST = "M1,M5"
ENTRY_GUARD_TFS_MICRO = "M5,H1"
ENTRY_GUARD_TFS_MACRO = "M5,H1,H4"
ENTRY_GUARD_TFS_MANUAL = "H1,H4"

# Spread guard settings
spread_guard_max_pips = "1.4"
spread_guard_release_pips = "1.1"
spread_guard_window_sec = "4.5"
spread_guard_cooldown_sec = "25"
spread_guard_min_high_samples = "3"
spread_guard_release_samples = "4"
spread_guard_max_age_ms = "4000"
spread_guard_baseline_window_sec = "300"
spread_guard_baseline_min_samples = "60"

# Data lag watchdog (tick遅延が続く場合に main を再起動)
DATA_LAG_RESTART_MS = "8000"
DATA_LAG_RESTART_STRIKES = "3"

# Tick stream idle reconnect guard
TICK_STREAM_MAX_IDLE_SEC = "10"
TICK_STREAM_MAX_IDLE_STRIKES = "2"

# Tick silence watchdog (no tick for N seconds -> restart)
TICK_SILENCE_RESTART_SEC = "20"
TICK_SILENCE_RESTART_STRIKES = "3"
TICK_SILENCE_GRACE_SEC = "120"

[macro_state]
snapshot_path = "fixtures/macro_snapshots/latest.json"
deadzone = "0.25"
gate_enabled = "false"

[event_window]
enabled = "true"
hours_before = "2"
hours_after = "1"
risk_multiplier = "0.3"

[exposure]
usd_long_max_lot = "2.5"

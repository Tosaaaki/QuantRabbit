# Strategy-specific BE trail / TP move overrides.
# Values are in pips and seconds.

defaults:
  apply_when_soft_tp: true
  neg_exit:
    enabled: true
    allow_reasons:
      - hard_stop
      - tech_hard_stop
      - tech_return_fail
      - tech_reversal_combo
      - tech_candle_reversal
      - tech_nwave_flip
      - rsi_fade
      - m1_rsi_fade
      - vwap_cut
      - m1_vwap_cut
      - atr_spike
      - m1_atr_spike
      - structure_break
      - m1_structure_break
      - reentry_reset
      - max_hold
      - max_adverse
      - lock_floor
      - time_stop
      - timeout
      - mtf_reversal
      - trend_failure
      - trend_exhaust
      - drawdown
      - max_drawdown
      - health_exit
      - hazard_exit
      - margin_health
      - free_margin_low
      - margin_usage_high
    deny_reasons: []
  min_profit_pips:
    macro: 1.6
    micro: 1.2
    scalp: 1.0
  min_profit_ratio:
    macro: 0.45
    micro: 0.40
    scalp: 0.80
  min_profit_ratio_min_tp_pips: 1.5
  min_profit_ratio_reasons:
    - partial_take
    - fast_cut_time
    - lock_floor
    - take_profit
    - range_timeout
    - time_stop
    - trail_take
    - lock_release
    - take_profit_zone
    - rsi_take
    - trail_lock
    - profit_lock
    - lock_trail
    - near_be
  be_profile:
    macro: {trigger_pips: 6.8, lock_ratio: 0.55, min_lock_pips: 2.6, cooldown_sec: 90}
    micro: {trigger_pips: 2.2, lock_ratio: 0.50, min_lock_pips: 0.60, cooldown_sec: 45}
    scalp: {trigger_pips: 1.6, lock_ratio: 0.35, min_lock_pips: 0.50, cooldown_sec: 20}
  start_delay_sec:
    micro: 25
    scalp: 12
  max_delay_sec:
    micro: 70
    scalp: 35
  tp_move:
    enabled: true
    macro: {trigger_pips: 6.0, buffer_pips: 2.5}
    micro: {trigger_pips: 2.0, buffer_pips: 1.0}
    scalp: {trigger_pips: 1.0, buffer_pips: 0.8}
  tp_move_min_gap_pips: 0.3
  exit_profile:
    min_hold_sec: 10
    profit_pips: 1.5
    trail_start_pips: 2.1
    trail_backoff_pips: 0.7
    lock_buffer_pips: 0.35
    range_profit_pips: 1.2
    range_trail_start_pips: 1.7
    range_trail_backoff_pips: 0.55
    range_lock_buffer_pips: 0.25
    range_max_hold_sec: 600
    loss_cut_enabled: false
    loss_cut_require_sl: true
    loss_cut_soft_pips: 12
    loss_cut_hard_pips: 30
    loss_cut_max_hold_sec: 1200
    loss_cut_cooldown_sec: 8
    loss_cut_reason_soft: m1_structure_break
    loss_cut_reason_hard: max_adverse
    loss_cut_reason_time: time_stop
    tick_imb:
      partial_enabled: true
      partial_trigger_pips: 1.0
      partial_fraction: 0.4
      partial_min_units: 1000
      partial_min_remaining: 1000
      be_buffer_pips: 0.2
      min_hold_sec: 0
      profit_pips: 0
      trail_start_pips: 0
      trail_backoff_pips: 0
      lock_buffer_pips: 0
      max_hold_sec: 0
      max_adverse_pips: 0
  pro_stop:
    enabled: true
    score_min: 2
    require_signal: true
    soft_pips: 3.4
    hard_pips: 9.5
    min_hold_sec: 203
    max_hold_sec: 1760

hold_until_profit:
  # Block closes for specific trades until they are in profit.
  # Matches are case-insensitive.
  client_order_ids:
    - "qr-1769197611427-hybrid-ImpulseRetrace-55c1d9c8f"
  trade_ids:
    - "181052"
  min_profit_pips: 0.0
  strict: false

strategies:
  TrendMA:
    min_profit_pips: 2.0
    be_profile: {trigger_pips: 7.0, lock_ratio: 0.60, min_lock_pips: 3.0, cooldown_sec: 90}
    tp_move: {trigger_pips: 7.5, buffer_pips: 3.0}
    pro_stop: {soft_pips: 1.6, hard_pips: 9.8, min_hold_sec: 113, max_hold_sec: 3437, soft_atr_mult: 1.0, hard_atr_mult: 1.8}
    neg_exit:
      allow_reasons:
        - hard_stop
        - tech_hard_stop
        - tech_return_fail
        - tech_reversal_combo
        - tech_candle_reversal
        - tech_nwave_flip
        - rsi_fade
        - vwap_cut
        - atr_spike
        - structure_break
        - trend_failure
        - trend_exhaust
        - drawdown
        - max_drawdown
        - health_exit
        - hazard_exit
        - margin_health
        - free_margin_low
        - margin_usage_high

  H1Momentum:
    be_profile: {trigger_pips: 6.5, lock_ratio: 0.55, min_lock_pips: 2.8, cooldown_sec: 80}
    tp_move: {trigger_pips: 7.0, buffer_pips: 2.8}
    pro_stop: {soft_pips: 2.2, hard_pips: 34.1, min_hold_sec: 160, max_hold_sec: 1484, soft_atr_mult: 1.0, hard_atr_mult: 1.8}
    neg_exit:
      allow_reasons:
        - hard_stop
        - tech_hard_stop
        - tech_return_fail
        - tech_reversal_combo
        - tech_candle_reversal
        - tech_nwave_flip
        - rsi_fade
        - vwap_cut
        - atr_spike
        - structure_break
        - trend_failure
        - trend_exhaust
        - drawdown
        - max_drawdown
        - health_exit
        - hazard_exit
        - margin_health
        - free_margin_low
        - margin_usage_high

  trend_h1:
    be_profile: {trigger_pips: 5.5, lock_ratio: 0.55, min_lock_pips: 2.4, cooldown_sec: 75}
    tp_move: {trigger_pips: 6.2, buffer_pips: 2.4}
    pro_stop: {soft_pips: 2.2, hard_pips: 34.1, min_hold_sec: 160, max_hold_sec: 1484, soft_atr_mult: 1.0, hard_atr_mult: 1.8}
    neg_exit:
      allow_reasons:
        - hard_stop
        - tech_hard_stop
        - tech_return_fail
        - tech_reversal_combo
        - tech_candle_reversal
        - tech_nwave_flip
        - rsi_fade
        - vwap_cut
        - atr_spike
        - structure_break
        - trend_failure
        - trend_exhaust
        - drawdown
        - max_drawdown
        - health_exit
        - hazard_exit
        - margin_health
        - free_margin_low
        - margin_usage_high

  LondonMomentum:
    be_profile: {trigger_pips: 5.8, lock_ratio: 0.55, min_lock_pips: 2.4, cooldown_sec: 70}
    tp_move: {trigger_pips: 6.2, buffer_pips: 2.6}
    pro_stop: {soft_atr_mult: 1.0, hard_atr_mult: 1.8}

  manual_swing:
    be_profile: {trigger_pips: 6.0, lock_ratio: 0.55, min_lock_pips: 2.6, cooldown_sec: 90}
    tp_move: {trigger_pips: 6.8, buffer_pips: 2.8}
    pro_stop: {soft_atr_mult: 1.0, hard_atr_mult: 1.8}

  BB_RSI:
    be_profile: {trigger_pips: 1.8, lock_ratio: 0.52, min_lock_pips: 0.60, cooldown_sec: 35}
    tp_move: {trigger_pips: 1.4, buffer_pips: 0.9}
    pro_stop: {soft_pips: 2.14, hard_pips: 4.03, min_hold_sec: 121, max_hold_sec: 364, soft_atr_mult: 0.7, hard_atr_mult: 1.2}

  BB_RSI_Fast:
    be_profile: {trigger_pips: 1.6, lock_ratio: 0.55, min_lock_pips: 0.55, cooldown_sec: 30}
    tp_move: {trigger_pips: 1.2, buffer_pips: 0.8}
    pro_stop: {soft_atr_mult: 0.7, hard_atr_mult: 1.2}

  MicroRangeBreak:
    be_profile: {trigger_pips: 1.8, lock_ratio: 0.50, min_lock_pips: 0.60, cooldown_sec: 35}
    tp_move: {trigger_pips: 1.5, buffer_pips: 0.9}
    pro_stop: {soft_pips: 3.4, hard_pips: 9.5, min_hold_sec: 203, max_hold_sec: 1760, soft_atr_mult: 0.8, hard_atr_mult: 1.4}

  MicroVWAPBound:
    be_profile: {trigger_pips: 1.6, lock_ratio: 0.55, min_lock_pips: 0.60, cooldown_sec: 35}
    tp_move: {trigger_pips: 1.4, buffer_pips: 0.9}
    pro_stop: {soft_atr_mult: 0.7, hard_atr_mult: 1.2}
    neg_exit:
      allow_reasons:
        - reversion_*

  MomentumBurst:
    be_profile: {trigger_pips: 1.8, lock_ratio: 0.50, min_lock_pips: 0.60, cooldown_sec: 35}
    tp_move: {trigger_pips: 1.5, buffer_pips: 0.9}
    pro_stop: {soft_pips: 4.8, hard_pips: 8.12, min_hold_sec: 306, max_hold_sec: 2382, soft_atr_mult: 0.8, hard_atr_mult: 1.4}

  MicroLevelReactor:
    be_profile: {trigger_pips: 1.7, lock_ratio: 0.50, min_lock_pips: 0.60, cooldown_sec: 35}
    tp_move: {trigger_pips: 1.4, buffer_pips: 0.9}
    pro_stop: {soft_atr_mult: 0.7, hard_atr_mult: 1.2}

  mirror_spike:
    pro_stop: {soft_pips: 5.22, hard_pips: 11.69, min_hold_sec: 660, max_hold_sec: 1979, soft_atr_mult: 0.6, hard_atr_mult: 1.0}

  mirror_spike_tight:
    pro_stop: {soft_pips: 2.4, hard_pips: 4.13, min_hold_sec: 34, max_hold_sec: 288, soft_atr_mult: 0.6, hard_atr_mult: 1.0}

  Donchian55:
    pro_stop: {soft_pips: 9.84, hard_pips: 31.19, min_hold_sec: 815, max_hold_sec: 2836, soft_atr_mult: 1.0, hard_atr_mult: 1.8}

  Donchian5:
    pro_stop: {soft_pips: 6.84, hard_pips: 21.36, min_hold_sec: 859, max_hold_sec: 7200, soft_atr_mult: 1.0, hard_atr_mult: 1.8}

  MicroPullbackEMA:
    be_profile: {trigger_pips: 2.0, lock_ratio: 0.48, min_lock_pips: 0.65, cooldown_sec: 40}
    tp_move: {trigger_pips: 1.6, buffer_pips: 1.0}
    pro_stop: {soft_pips: 3.74, hard_pips: 6.82, min_hold_sec: 151, max_hold_sec: 1245, soft_atr_mult: 0.8, hard_atr_mult: 1.4}

  MicroMomentumStack:
    be_profile: {trigger_pips: 2.2, lock_ratio: 0.45, min_lock_pips: 0.70, cooldown_sec: 45}
    tp_move: {trigger_pips: 1.8, buffer_pips: 1.1}
    pro_stop: {soft_atr_mult: 0.8, hard_atr_mult: 1.4}

  TrendMomentumMicro:
    be_profile: {trigger_pips: 2.3, lock_ratio: 0.45, min_lock_pips: 0.70, cooldown_sec: 45}
    tp_move: {trigger_pips: 1.9, buffer_pips: 1.1}
    pro_stop: {soft_pips: 1.7, hard_pips: 2.4, min_hold_sec: 71, max_hold_sec: 312, soft_atr_mult: 0.8, hard_atr_mult: 1.4}

  MicroVWAPRevert:
    be_profile: {trigger_pips: 1.6, lock_ratio: 0.55, min_lock_pips: 0.60, cooldown_sec: 35}
    tp_move: {trigger_pips: 1.3, buffer_pips: 0.9}
    pro_stop: {soft_atr_mult: 0.7, hard_atr_mult: 1.2}
    neg_exit:
      allow_reasons:
        - reversion_*

  TickImbalance:
    min_profit_pips: 1.4
    min_profit_ratio: 0.80
    pro_stop: {soft_pips: 6.4, hard_pips: 12.07, min_hold_sec: 1200, max_hold_sec: 3600, soft_atr_mult: 0.6, hard_atr_mult: 1.0}
    exit_profile:
      min_hold_sec: 8
      profit_pips: 1.1
      trail_start_pips: 1.5
      trail_backoff_pips: 0.55
      lock_buffer_pips: 0.28
      range_profit_pips: 1.0
      range_trail_start_pips: 1.4
      range_trail_backoff_pips: 0.5
      range_lock_buffer_pips: 0.24
      range_max_hold_sec: 1500
      loss_cut_enabled: true
      loss_cut_require_sl: false
      loss_cut_soft_pips: 6.0
      loss_cut_hard_pips: 12.0
      loss_cut_max_hold_sec: 1800
      loss_cut_cooldown_sec: 6
      tick_imb:
        partial_enabled: true
        partial_trigger_pips: 0.9
        partial_fraction: 0.4
        partial_min_units: 1000
        partial_min_remaining: 1000
        be_buffer_pips: 0.2
        min_hold_sec: 0
        profit_pips: 1.0
        trail_start_pips: 1.3
        trail_backoff_pips: 0.5
        lock_buffer_pips: 0.25
        max_hold_sec: 1500
        max_adverse_pips: 12.0

  LevelReject:
    min_profit_pips: 1.4
    min_profit_ratio: 0.80
    pro_stop: {soft_pips: 0.8, hard_pips: 14.1, min_hold_sec: 175, max_hold_sec: 5899, soft_atr_mult: 0.6, hard_atr_mult: 1.0}
    exit_profile:
      min_hold_sec: 10
      profit_pips: 2.3
      trail_start_pips: 2.6
      trail_backoff_pips: 0.6
      lock_buffer_pips: 0.3
      range_profit_pips: 2.3
      range_trail_start_pips: 2.6
      range_trail_backoff_pips: 0.55
      range_lock_buffer_pips: 0.26
      range_max_hold_sec: 1800
      loss_cut_enabled: true
      loss_cut_require_sl: false
      loss_cut_soft_pips: 5.5
      loss_cut_hard_pips: 10.5
      loss_cut_max_hold_sec: 1800
      loss_cut_cooldown_sec: 6

  TickWickReversal:
    min_profit_pips: 1.2
    min_profit_ratio: 0.80
    exit_profile:
      min_hold_sec: 6
      profit_pips: 1.1
      trail_start_pips: 1.5
      trail_backoff_pips: 0.55
      lock_buffer_pips: 0.25
      range_profit_pips: 1.0
      range_trail_start_pips: 1.4
      range_trail_backoff_pips: 0.5
      range_lock_buffer_pips: 0.22
      range_max_hold_sec: 240
      loss_cut_enabled: true
      loss_cut_require_sl: false
      loss_cut_soft_pips: 3.2
      loss_cut_hard_pips: 6.0
      loss_cut_max_hold_sec: 240
      loss_cut_cooldown_sec: 4
      loss_cut_reason_soft: max_adverse
      loss_cut_reason_hard: max_adverse
      loss_cut_reason_time: time_stop

  MomentumPulse:
    be_profile: {trigger_pips: 1.7, lock_ratio: 0.50, min_lock_pips: 0.60, cooldown_sec: 35}
    tp_move: {trigger_pips: 1.4, buffer_pips: 0.9}
    pro_stop: {soft_pips: 3.4, hard_pips: 4.94, min_hold_sec: 112, max_hold_sec: 3601, soft_atr_mult: 0.8, hard_atr_mult: 1.4}

  VolCompressionBreak:
    be_profile: {trigger_pips: 1.8, lock_ratio: 0.48, min_lock_pips: 0.60, cooldown_sec: 40}
    tp_move: {trigger_pips: 1.5, buffer_pips: 0.9}
    pro_stop: {soft_pips: 1.4, hard_pips: 3.8, min_hold_sec: 20, max_hold_sec: 7200, soft_atr_mult: 0.8, hard_atr_mult: 1.4}

  RangeFader:
    be_profile: {trigger_pips: 1.0, lock_ratio: 0.45, min_lock_pips: 0.40, cooldown_sec: 12}
    tp_move: {trigger_pips: 0.8, buffer_pips: 0.6}
    start_delay_sec: 8
    max_delay_sec: 20
    pro_stop: {soft_pips: 4.68, hard_pips: 14.84, min_hold_sec: 353, max_hold_sec: 7200, soft_atr_mult: 0.6, hard_atr_mult: 1.0}
    neg_exit:
      allow_reasons:
        - reversion_*

  PulseBreak:
    be_profile: {trigger_pips: 1.4, lock_ratio: 0.38, min_lock_pips: 0.45, cooldown_sec: 15}
    tp_move: {trigger_pips: 1.1, buffer_pips: 0.7}
    start_delay_sec: 10
    max_delay_sec: 25
    pro_stop: {soft_atr_mult: 0.6, hard_atr_mult: 1.0}

  ImpulseRetrace:
    be_profile: {trigger_pips: 1.2, lock_ratio: 0.40, min_lock_pips: 0.45, cooldown_sec: 15}
    tp_move: {trigger_pips: 0.9, buffer_pips: 0.65}
    start_delay_sec: 10
    max_delay_sec: 25
    pro_stop: {soft_pips: 4.5, hard_pips: 19.5, min_hold_sec: 224, max_hold_sec: 1695, soft_atr_mult: 0.6, hard_atr_mult: 1.0}

  ImpulseRetraceScalp:
    be_profile: {trigger_pips: 1.2, lock_ratio: 0.40, min_lock_pips: 0.45, cooldown_sec: 15}
    tp_move: {trigger_pips: 0.9, buffer_pips: 0.65}
    start_delay_sec: 10
    max_delay_sec: 25
    pro_stop: {soft_atr_mult: 0.6, hard_atr_mult: 1.0}

  M1Scalper:
    be_profile: {trigger_pips: 1.6, lock_ratio: 0.35, min_lock_pips: 0.50, cooldown_sec: 20}
    tp_move: {trigger_pips: 1.2, buffer_pips: 0.8}
    pro_stop: {soft_pips: 1.8, hard_pips: 6.8, min_hold_sec: 22, max_hold_sec: 1140, soft_atr_mult: 0.6, hard_atr_mult: 1.0}
    neg_exit:
      allow_reasons:
        - hard_stop
        - drawdown
        - max_drawdown
        - health_exit
        - hazard_exit
        - margin_health
        - free_margin_low
        - margin_usage_high
        - tech_hard_stop
        - fast_cut_*
        - time_cut
        - rsi_fade
        - m1_rsi_fade
        - vwap_cut
        - m1_vwap_cut
        - structure_break
        - m1_structure_break
        - m1_atr_spike
        - tech_reversal_combo
        - tech_nwave_flip
        - tech_candle_reversal
        - section_*
      deny_reasons:
        - tech_return_fail

  fast_scalp:
    min_profit_ratio: 0.80
    min_profit_ratio_min_tp_pips: 0.6
    be_profile: {trigger_pips: 1.2, lock_ratio: 0.40, min_lock_pips: 0.45, cooldown_sec: 12}
    tp_move: {trigger_pips: 0.9, buffer_pips: 0.6}
    pro_stop: {soft_pips: 1.2, hard_pips: 2.3, min_hold_sec: 15, max_hold_sec: 120, soft_atr_mult: 0.5, hard_atr_mult: 0.9}

  OnePipMakerS1:
    be_profile: {trigger_pips: 0.9, lock_ratio: 0.45, min_lock_pips: 0.35, cooldown_sec: 10}
    tp_move: {trigger_pips: 0.7, buffer_pips: 0.5}
    pro_stop: {soft_atr_mult: 0.5, hard_atr_mult: 0.9}

  pullback_s5:
    be_profile: {trigger_pips: 1.2, lock_ratio: 0.40, min_lock_pips: 0.45, cooldown_sec: 14}
    tp_move: {trigger_pips: 0.9, buffer_pips: 0.6}
    pro_stop: {soft_atr_mult: 0.6, hard_atr_mult: 1.0}

  pullback_runner_s5:
    be_profile: {trigger_pips: 1.4, lock_ratio: 0.38, min_lock_pips: 0.45, cooldown_sec: 16}
    tp_move: {trigger_pips: 1.0, buffer_pips: 0.7}
    pro_stop: {soft_atr_mult: 0.6, hard_atr_mult: 1.0}

  impulse_break_s5:
    be_profile: {trigger_pips: 1.5, lock_ratio: 0.38, min_lock_pips: 0.50, cooldown_sec: 16}
    tp_move: {trigger_pips: 1.1, buffer_pips: 0.7}
    pro_stop: {soft_atr_mult: 0.6, hard_atr_mult: 1.0}

  impulse_retest_s5:
    be_profile: {trigger_pips: 1.3, lock_ratio: 0.40, min_lock_pips: 0.45, cooldown_sec: 15}
    tp_move: {trigger_pips: 1.0, buffer_pips: 0.7}
    pro_stop: {soft_pips: 5.0, hard_pips: 9.8, min_hold_sec: 282, max_hold_sec: 2141, soft_atr_mult: 0.6, hard_atr_mult: 1.0}

  impulse_momentum_s5:
    be_profile: {trigger_pips: 1.5, lock_ratio: 0.38, min_lock_pips: 0.50, cooldown_sec: 16}
    tp_move: {trigger_pips: 1.1, buffer_pips: 0.7}
    pro_stop: {soft_atr_mult: 0.6, hard_atr_mult: 1.0}

  vwap_magnet_s5:
    be_profile: {trigger_pips: 1.1, lock_ratio: 0.45, min_lock_pips: 0.40, cooldown_sec: 12}
    tp_move: {trigger_pips: 0.9, buffer_pips: 0.6}
    pro_stop: {soft_atr_mult: 0.6, hard_atr_mult: 1.0}

  MacroTechFusion:
    pro_stop: {soft_atr_mult: 1.0, hard_atr_mult: 1.8}

  MicroPullbackFib:
    pro_stop: {soft_atr_mult: 0.8, hard_atr_mult: 1.4}

  RangeCompressionBreak:
    pro_stop: {soft_atr_mult: 0.7, hard_atr_mult: 1.2}

  ScalpReversalNWave:
    pro_stop: {soft_atr_mult: 0.6, hard_atr_mult: 1.0}

  VolSpikeRider:
    pro_stop: {soft_atr_mult: 0.6, hard_atr_mult: 1.0}

  mm_lite:
    pro_stop: {soft_atr_mult: 0.5, hard_atr_mult: 0.9}

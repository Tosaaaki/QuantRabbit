[Unit]
Description=QuantRabbit Autotune Review UI
After=network.target

[Service]
Type=simple
WorkingDirectory=/home/tossaki/QuantRabbit
ExecStart=/home/tossaki/QuantRabbit/.venv/bin/uvicorn apps.autotune_ui:app --host 0.0.0.0 --port 8088
Restart=on-failure
RestartSec=5
User=tossaki
Environment=PYTHONUNBUFFERED=1
Environment=UI_SNAPSHOT_LITE_MODE=full
# UI はレスポンス優先。position_manager 側が詰まっても fail-fast で軽量表示へ降格する。
Environment=POSITION_MANAGER_SERVICE_FALLBACK_LOCAL=0
Environment=POSITION_MANAGER_SERVICE_TIMEOUT=1.5
Environment=POSITION_MANAGER_SERVICE_PERFORMANCE_SUMMARY_TIMEOUT=2.0
Environment=POSITION_MANAGER_SERVICE_OPEN_POSITIONS_TIMEOUT=1.2
Environment=POSITION_MANAGER_SERVICE_FAIL_BACKOFF_SEC=2.0
Environment=POSITION_MANAGER_SERVICE_FAIL_BACKOFF_MAX_SEC=10.0
EnvironmentFile=-/home/tossaki/QuantRabbit/ops/env/quant-v2-runtime.env
Environment=AUTOTUNE_BQ_TABLE=quantrabbit.autotune_runs
Environment=AUTOTUNE_BQ_SETTINGS_TABLE=quantrabbit.autotune_settings

[Install]
WantedBy=multi-user.target

# 5s ping scalp tuning (2026-02-12)
# Goal: reduce whipsaw stop-loss clusters without fully starving entries.

# Signal freshness and windowing.
SCALP_PING_5S_MAX_TICK_AGE_MS=5000
SCALP_PING_5S_SIGNAL_WINDOW_SEC=8.0
SCALP_PING_5S_WINDOW_SEC=20.0
SCALP_PING_5S_MIN_TICKS=4
SCALP_PING_5S_MIN_SIGNAL_TICKS=3

# Raise entry quality from ultra-aggressive baseline.
SCALP_PING_5S_MIN_TICK_RATE=0.50
SCALP_PING_5S_MOMENTUM_TRIGGER_PIPS=0.10
SCALP_PING_5S_MOMENTUM_SPREAD_MULT=0.20
SCALP_PING_5S_IMBALANCE_MIN=0.50
SCALP_PING_5S_MAX_SPREAD_PIPS=1.00

# MTF heat regime: switch continuation/reversion by market temperature.
SCALP_PING_5S_MTF_REGIME_ENABLED=1
SCALP_PING_5S_MTF_TREND_NEUTRAL_SCORE=0.14
SCALP_PING_5S_MTF_TREND_STRONG_SCORE=0.28
SCALP_PING_5S_MTF_HEAT_CONTINUATION_MIN=0.62
SCALP_PING_5S_MTF_HEAT_REVERSION_MAX=0.40
SCALP_PING_5S_MTF_CONTINUATION_ALIGN_BOOST_MAX=0.95
SCALP_PING_5S_MTF_CONTINUATION_OPPOSITE_UNITS_MULT=0.25
SCALP_PING_5S_MTF_CONTINUATION_BLOCK_HEAT=0.78
SCALP_PING_5S_MTF_REVERSION_TRIGGER_MULT=1.30
SCALP_PING_5S_MTF_REVERSION_IMBALANCE_MIN=0.60
SCALP_PING_5S_MTF_REVERSION_BOOST_MAX=0.30

# 4-horizon directional synthesis (long/mid/short/ultra-short).
SCALP_PING_5S_HORIZON_BIAS_ENABLED=0
SCALP_PING_5S_HORIZON_NEUTRAL_SCORE=0.14
SCALP_PING_5S_HORIZON_ALIGN_SCORE_MIN=0.22
SCALP_PING_5S_HORIZON_BLOCK_SCORE=0.44
SCALP_PING_5S_HORIZON_OPPOSITE_UNITS_MULT=0.40
SCALP_PING_5S_HORIZON_ALIGN_BOOST_MAX=0.32
SCALP_PING_5S_HORIZON_LONG_WEIGHT=0.42
SCALP_PING_5S_HORIZON_MID_WEIGHT=0.30
SCALP_PING_5S_HORIZON_SHORT_WEIGHT=0.18
SCALP_PING_5S_HORIZON_MICRO_WEIGHT=0.10
SCALP_PING_5S_HORIZON_LOG_INTERVAL_SEC=8

# Disable lookahead hard gate to avoid entry starvation in thin microstructure.
SCALP_PING_5S_LOOKAHEAD_GATE_ENABLED=0
SCALP_PING_5S_EXTREMA_GATE_ENABLED=0

# Pace control.
SCALP_PING_5S_ENTRY_COOLDOWN_SEC=0.30
SCALP_PING_5S_MIN_ORDER_SPACING_SEC=0.20
SCALP_PING_5S_MAX_ORDERS_PER_MINUTE=84
SCALP_PING_5S_MAX_ACTIVE_TRADES=40
SCALP_PING_5S_MAX_PER_DIRECTION=24
SCALP_PING_5S_MIN_FREE_MARGIN_RATIO=0.09
SCALP_PING_5S_LOW_MARGIN_HEDGE_RELIEF_ENABLED=1
SCALP_PING_5S_LOW_MARGIN_HEDGE_RELIEF_MIN_FREE_RATIO=0.015
SCALP_PING_5S_LOW_MARGIN_HEDGE_RELIEF_MIN_MARGIN_AVAILABLE_JPY=1500
SCALP_PING_5S_LOW_MARGIN_HEDGE_RELIEF_MAX_IMBALANCE_FRACTION=0.60
SCALP_PING_5S_LOW_MARGIN_HEDGE_RELIEF_LOG_INTERVAL_SEC=8
SCALP_PING_5S_ALLOW_OPPOSITE_WHEN_MAX_ACTIVE=1
# Expand entry slots only when margin headroom is healthy.
SCALP_PING_5S_ACTIVE_CAP_MARGIN_BYPASS_ENABLED=1
SCALP_PING_5S_ACTIVE_CAP_BYPASS_MIN_FREE_RATIO=0.12
SCALP_PING_5S_ACTIVE_CAP_BYPASS_MIN_MARGIN_AVAILABLE_JPY=30000
SCALP_PING_5S_ACTIVE_CAP_BYPASS_EXTRA_TOTAL=4
SCALP_PING_5S_ACTIVE_CAP_BYPASS_EXTRA_PER_DIRECTION=2
SCALP_PING_5S_ACTIVE_CAP_BYPASS_LOG_INTERVAL_SEC=8

# Strategy-level performance gate (re-enable for scalp_ping_5s_live).
SCALP_PING_5S_PERF_GUARD_ENABLED=1
SCALP_PING_5S_PERF_GUARD_MODE=warn
SCALP_PING_5S_PERF_GUARD_SETUP_ENABLED=1
PERF_GUARD_SETUP_ENABLED_STRATEGY_SCALP_PING_5S_LIVE=1
PERF_GUARD_SETUP_MIN_TRADES_STRATEGY_SCALP_PING_5S_LIVE=8
PERF_GUARD_SETUP_PF_MIN_STRATEGY_SCALP_PING_5S_LIVE=1.08
PERF_GUARD_SETUP_WIN_MIN_STRATEGY_SCALP_PING_5S_LIVE=0.55
PERF_GUARD_SETUP_AVG_PIPS_MIN_STRATEGY_SCALP_PING_5S_LIVE=0.05
PERF_GUARD_MIN_TRADES_STRATEGY_SCALP_PING_5S_LIVE=20
PERF_GUARD_PF_MIN_STRATEGY_SCALP_PING_5S_LIVE=1.03
PERF_GUARD_WIN_MIN_STRATEGY_SCALP_PING_5S_LIVE=0.53
PERF_GUARD_SL_LOSS_RATE_MIN_TRADES=12
PERF_GUARD_SL_LOSS_RATE_MAX_STRATEGY_SCALP_PING_5S_LIVE=0.30

# Keep hedge-recovery behavior and current sizing envelope.
SCALP_PING_5S_NO_HEDGE_ENTRY=0
SCALP_PING_5S_MIN_UNITS=300
SCALP_PING_5S_BASE_ENTRY_UNITS=1200
SCALP_PING_5S_MAX_UNITS=3500

# User request (2026-02-12): fixed take-profit and no stop-loss.
SCALP_PING_5S_TP_BASE_PIPS=0.50
SCALP_PING_5S_TP_NET_MIN_PIPS=0.50
SCALP_PING_5S_TP_MAX_PIPS=0.50
SCALP_PING_5S_TP_MOMENTUM_BONUS_MAX=0.00
SCALP_PING_5S_USE_SL=0
ORDER_ENABLE_STOP_LOSS_SCALP_FAST=0
FORECAST_EXEC_HINT_ENABLED=0
ORDER_MIN_RR_SCALP_FAST=0

# Re-enable adaptive force-exit with MTF+Fib defer logic.
SCALP_PING_5S_FORCE_EXIT_MAX_HOLD_SEC=90
SCALP_PING_5S_FORCE_EXIT_MAX_FLOATING_LOSS_PIPS=0
SCALP_PING_5S_FORCE_EXIT_RECOVERY_WINDOW_SEC=40
SCALP_PING_5S_FORCE_EXIT_RECOVERABLE_LOSS_PIPS=1.4
SCALP_PING_5S_FORCE_EXIT_GIVEBACK_ENABLED=0
SCALP_PING_5S_FORCE_EXIT_GIVEBACK_ARM_PIPS=0
SCALP_PING_5S_FORCE_EXIT_GIVEBACK_BACKOFF_PIPS=0
SCALP_PING_5S_FORCE_EXIT_GIVEBACK_MIN_HOLD_SEC=0
SCALP_PING_5S_FORCE_EXIT_GIVEBACK_PROTECT_PIPS=0
SCALP_PING_5S_FORCE_EXIT_MTF_FIB_HOLD_ENABLED=1
SCALP_PING_5S_FORCE_EXIT_MTF_FIB_LOOKBACK_M5=72
SCALP_PING_5S_FORCE_EXIT_MTF_FIB_LOOKBACK_H1=36
SCALP_PING_5S_FORCE_EXIT_MTF_FIB_LOWER=0.382
SCALP_PING_5S_FORCE_EXIT_MTF_FIB_UPPER=0.618
SCALP_PING_5S_FORCE_EXIT_MTF_FIB_MIN_RANGE_PIPS=6.0
SCALP_PING_5S_FORCE_EXIT_MTF_FIB_MAX_WAIT_SEC=180
SCALP_PING_5S_FORCE_EXIT_MTF_FIB_MAX_HOLD_LOSS_PIPS=3.8
SCALP_PING_5S_FORCE_EXIT_MTF_FIB_MIN_RECOVER_PIPS=0.45
SCALP_PING_5S_FORCE_EXIT_MTF_FIB_PROJECTED_MAX_LOSS_PIPS=1.6
SCALP_PING_5S_FORCE_EXIT_MTF_FIB_MAX_TARGET_PIPS=2.6
SCALP_PING_5S_FORCE_EXIT_MTF_FIB_OPPOSITE_HEAT_BLOCK=0.72
SCALP_PING_5S_FORCE_EXIT_MTF_FIB_OPPOSITE_RSI=42
SCALP_PING_5S_FORCE_EXIT_MTF_FIB_OPPOSITE_EMA_GAP_PIPS=0.35
SCALP_PING_5S_FORCE_EXIT_MTF_FIB_LOG_INTERVAL_SEC=10

# Profit-bank close: release legacy losses only from realized gains, while keeping net profit.
SCALP_PING_5S_PROFIT_BANK_ENABLED=1
SCALP_PING_5S_PROFIT_BANK_START_TIME_UTC=2026-02-12T05:00:51+00:00
SCALP_PING_5S_PROFIT_BANK_REASON=profit_bank_release
SCALP_PING_5S_PROFIT_BANK_MIN_GROSS_PROFIT_JPY=250
SCALP_PING_5S_PROFIT_BANK_MIN_NET_KEEP_JPY=180
SCALP_PING_5S_PROFIT_BANK_SPEND_RATIO=0.35
SCALP_PING_5S_PROFIT_BANK_MIN_BUFFER_JPY=120
SCALP_PING_5S_PROFIT_BANK_MIN_TARGET_LOSS_JPY=120
SCALP_PING_5S_PROFIT_BANK_MAX_TARGET_LOSS_JPY=1800
SCALP_PING_5S_PROFIT_BANK_TARGET_MIN_HOLD_SEC=300
SCALP_PING_5S_PROFIT_BANK_TARGET_ORDER=largest_loss
SCALP_PING_5S_PROFIT_BANK_TARGET_REQUIRE_OPEN_BEFORE_START=0
SCALP_PING_5S_PROFIT_BANK_MAX_ACTIONS=1
SCALP_PING_5S_PROFIT_BANK_COOLDOWN_SEC=30
SCALP_PING_5S_PROFIT_BANK_STATS_TTL_SEC=6
SCALP_PING_5S_PROFIT_BANK_LOG_INTERVAL_SEC=12
# User-specified exclusions (do not target these trades for profit-bank close).
SCALP_PING_5S_PROFIT_BANK_EXCLUDE_TRADE_IDS=329422,329415,329410,329394,329389,329384,329379,329374,328353,328348,328331,328326,323242,323133,321205,321087,320929,320924,320911,320900,320895,320890,329694,329689
SCALP_PING_5S_PROFIT_BANK_EXCLUDE_CLIENT_IDS=qr-1770872799120-scalp_ping_5-s9fffb167,qr-1770872749600-scalp_ping_5-s61203278,qr-1770872746224-scalp_ping_5-s6e22ae72,qr-1770872702941-scalp_ping_5-s6a2bffa6,qr-1770872700874-scalp_ping_5-s6901f401,qr-1770872691554-scalp_ping_5-s10d60b1a,qr-1770872675538-scalp_ping_5-sffc08fb5,qr-1770872674135-scalp_ping_5-sb6e9b626,qr-1770870793982-scalp_ping_5-sefc971d5,qr-1770870762848-scalp_ping_5-s22e19279,qr-1770870745162-scalp_ping_5-sd8f32f81,qr-1770870743891-scalp_ping_5-scd8e734b,qr-1770857567423-scalp_ping_5-l08fd980e,qr-1770857433765-scalp_ping_5-l91b1efe6,qr-1770818473454-scalp_ping_5-l34dc538b,qr-1770817409139-scalp_ping_5-l4677d3b5,qr-1770816922038-scalp_ping_5-lc592c86d,qr-1770816920605-scalp_ping_5-l8b755cb9,qr-1770816836372-scalp_ping_5-l0f8ca6fc,qr-1770816825745-scalp_ping_5-lbd0edb4a,qr-1770816815156-scalp_ping_5-l54f560f8,qr-1770816813980-scalp_ping_5-l4b50c983,qr-1770874871328-scalp_ping_5-l8883204e,qr-1770874870170-scalp_ping_5-l999ed97d

# Relax microstructure density gate enough to avoid starvation.
ORDER_ENTRY_QUALITY_MICROSTRUCTURE_ENABLED=0
ORDER_ENTRY_QUALITY_MICROSTRUCTURE_MIN_TICK_DENSITY_SCALP_FAST=0.90
SCALP_PING_5S_SNAPSHOT_TOPUP_TARGET_DENSITY=0.90
SCALP_PING_5S_SNAPSHOT_KEEPALIVE_MIN_DENSITY=0.90
